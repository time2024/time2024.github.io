<!DOCTYPE html><html lang="zh-CN" theme-mode="dark"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>R语言 | Zenith</title><link rel="icon" type="image/x-icon" href="/favicon.ico"><link rel="preload" as="font" crossorigin="anonymous" href="/font/Bender.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/BenderLight.ttf"><link rel="preload" as="font" crossorigin="anonymous" href="/font/JetBrainsMono-Regular.woff2"><link rel="stylesheet" href="/css/arknights.css"><style>@font-face {
  font-family: Bender;
  src: local('Bender'), url("/font/Bender.ttf"), url("/font/Bender.otf");
}
@font-face {
  font-family: BenderLight;
  src: local('BenderLight'), url("/font/BenderLight.ttf");
}
@font-face {
  font-family: 'JetBrains Mono';
  src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}
</style><script>var config = {"root":"/","search":{"preload":false,"activeHolder":"Enter here","blurHolder":"Search","noResult":"Data \"$0\" not found"},"code":{"codeInfo":"$0 - $1 lines","copy":"copy"}}</script><link type="text/css" rel="stylesheet" href="/lib/encrypt/hbe.style.css"><script src="//unpkg.com/mermaid@10.5.0/dist/mermaid.min.js"></script><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lightgallery.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-zoom.css"><link type="text/css" rel="stylesheet" href="//unpkg.com/lightgallery@2.7.1/css/lg-thumbnail.css"><link type="text/css" rel="stylesheet" href="/lib/fontawesome/css/all.min.css"><script>if (window.localStorage.getItem('theme-mode') === 'light')
 document.documentElement.setAttribute('theme-mode', 'light')
if (window.localStorage.getItem('theme-mode') === 'dark')
 document.documentElement.setAttribute('theme-mode', 'dark')</script><style>@font-face {
 font-family: BenderLight;
 src: local('Bender'), url("/font/BenderLight.woff2") format('woff2');
}
@font-face {
 font-family: 'JetBrains Mono';
 src: local('JetBrains Mono'), url('/font/JetBrainsMono-Regular.woff2') format('woff2');
}</style><style>:root {
 --dark-background: url('/img/yellow.jpg');
 --light-background: url('/img/green.jpg');
 --theme-encrypt-confirm: 'confirm'
}</style><script defer src="/js/arknights.js"></script><script defer src="/js/search.js"></script><script defer type="module">import mermaid from '//unpkg.com/mermaid@10.5.0/dist/mermaid.esm.mjs';
window.mermaid = mermaid;
code.paintMermaid();
</script><script async src="//unpkg.com/lightgallery@2.7.1/lightgallery.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/zoom/lg-zoom.min.js"></script><script async src="//unpkg.com/lightgallery@2.7.1/plugins/thumbnail/lg-thumbnail.min.js"></script><script async src="/lib/encrypt/hbe.js"></script><script async src="/js/pjax.js"></script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js','data-pjax','.busuanzi'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><script class="pjax-js">reset= () => {document.querySelector('.lg-container')?.remove()
lightGallery(document.getElementById('post-bg'), {
  plugins: [lgZoom,lgThumbnail],
  selector: '.item-img'})}</script><script>window.addEventListener("load",() => {pjax = new Pjax({
 cacheBust: false,
 selectors: ['title','article','#aside-block','.pjax-js'],
 switches: {'article': Pjax.switches.sideBySide},
 switchesOptions: {
   'article': {
     classNames: {
       remove: "pjax-out",
       add: "pjax-in"
     }
   }
 }
});
document.addEventListener("pjax:complete", reset);reset()})</script><!-- 爆炸红心效果 -->
<canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
<script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
<script type="text/javascript" src="/js/firework.js"></script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/rss.xml" title="Zenith" type="application/rss+xml">
</head><body><script>(function () {  
    var a_idx = 0;  
    window.onclick = function (event) {  
        var a = new Array("这一路上走走停停","顺着少年漂流的痕迹","迈出车站的前一刻","竟有些犹豫","不禁笑这近乡情怯","仍无法避免","而长野的天","依旧那么暖","风吹起了从前",
        "从前初识这世间","万般流连","看着天边似在眼前","也甘愿赴汤蹈火去走它一遍","如今走过这世间","万般流连","翻过岁月不同侧脸","措不及防闯入你的笑颜","我曾难自拔于世界之大","也沉溺于其中梦话","不得真假 不做挣扎 不惧笑话","我曾将青春翻涌成她","也曾指尖弹出盛夏","心之所动 且就随缘去吧","逆着光行走 任风吹雨打","短短的路走走停停","也有了几分的距离","不知抚摸的是故事","还是段心情","也许期待的不过是","与时间为敌","再次见到你","微凉晨光里","笑得很甜蜜","从前初识这世间","万般流连","看着天边似在眼前","也甘愿赴汤蹈火去走它一遍","如今走过这世间","万般流连","翻过岁月不同侧脸","措不及防闯入你的笑颜","我曾难自拔于世界之大","也沉溺于其中梦话","不做真假 不做挣扎 不惧笑话","我曾将青春翻涌成她","也曾指尖弹出盛夏","心之所动 且就随缘去吧","晚风吹起你鬓间的白发","抚平回忆留下的疤","你的眼中 明暗交杂 一笑生花","暮色遮住你蹒跚的步伐","走进床头藏起的画","画中的你 低着头说话","我仍感叹于世界之大","也沉醉于儿时情话","不剩真假 不做挣扎 无谓笑话","我终将青春还给了她","连同指尖弹出的盛夏","心之所动 就随风去了","以爱之名 你还愿意吗",
        "这一路上走走停停","顺着少年漂流的痕迹","迈出车站的前一刻","竟有些犹豫","不禁笑这近乡情怯","仍无法避免","而长野的天","依旧那么暖","风吹起了从前",
        "从前初识这世间","万般流连","看着天边似在眼前","也甘愿赴汤蹈火去走它一遍","如今走过这世间","万般流连","翻过岁月不同侧脸","措不及防闯入你的笑颜","我曾难自拔于世界之大","也沉溺于其中梦话","不得真假 不做挣扎 不惧笑话","我曾将青春翻涌成她","也曾指尖弹出盛夏","心之所动 且就随缘去吧","逆着光行走 任风吹雨打","短短的路走走停停","也有了几分的距离","不知抚摸的是故事","还是段心情","也许期待的不过是","与时间为敌","再次见到你","微凉晨光里","笑得很甜蜜","从前初识这世间","万般流连","看着天边似在眼前","也甘愿赴汤蹈火去走它一遍","如今走过这世间","万般流连","翻过岁月不同侧脸","措不及防闯入你的笑颜","我曾难自拔于世界之大","也沉溺于其中梦话","不做真假 不做挣扎 不惧笑话","我曾将青春翻涌成她","也曾指尖弹出盛夏","心之所动 且就随缘去吧","晚风吹起你鬓间的白发","抚平回忆留下的疤","你的眼中 明暗交杂 一笑生花","暮色遮住你蹒跚的步伐","走进床头藏起的画","画中的你 低着头说话","我仍感叹于世界之大","也沉醉于儿时情话","不剩真假 不做挣扎 无谓笑话","我终将青春还给了她","连同指尖弹出的盛夏","心之所动 就随风去了","以爱之名 你还愿意吗",
        "这一路上走走停停","顺着少年漂流的痕迹","迈出车站的前一刻","竟有些犹豫","不禁笑这近乡情怯","仍无法避免","而长野的天","依旧那么暖","风吹起了从前",
        "从前初识这世间","万般流连","看着天边似在眼前","也甘愿赴汤蹈火去走它一遍","如今走过这世间","万般流连","翻过岁月不同侧脸","措不及防闯入你的笑颜","我曾难自拔于世界之大","也沉溺于其中梦话","不得真假 不做挣扎 不惧笑话","我曾将青春翻涌成她","也曾指尖弹出盛夏","心之所动 且就随缘去吧","逆着光行走 任风吹雨打","短短的路走走停停","也有了几分的距离","不知抚摸的是故事","还是段心情","也许期待的不过是","与时间为敌","再次见到你","微凉晨光里","笑得很甜蜜","从前初识这世间","万般流连","看着天边似在眼前","也甘愿赴汤蹈火去走它一遍","如今走过这世间","万般流连","翻过岁月不同侧脸","措不及防闯入你的笑颜","我曾难自拔于世界之大","也沉溺于其中梦话","不做真假 不做挣扎 不惧笑话","我曾将青春翻涌成她","也曾指尖弹出盛夏","心之所动 且就随缘去吧","晚风吹起你鬓间的白发","抚平回忆留下的疤","你的眼中 明暗交杂 一笑生花","暮色遮住你蹒跚的步伐","走进床头藏起的画","画中的你 低着头说话","我仍感叹于世界之大","也沉醉于儿时情话","不剩真假 不做挣扎 无谓笑话","我终将青春还给了她","连同指尖弹出的盛夏","心之所动 就随风去了","以爱之名 你还愿意吗",
        "曾经有人让我听这首歌","可是那时的我还不谙情事","也没有真正认真的听完整首歌","直到后来","分开后再听时才发现","原来我错过了","曾经的阿芒","你还好吗");  

        var heart = document.createElement("p"); // 创建p元素，这里从b改为p  
        heart.onselectstart = function() { return false; }; // 简化防止拖动的代码  

        document.body.appendChild(heart).textContent = a[a_idx]; // 使用textContent代替innerHTML，因为这里只是文本  
        a_idx = (a_idx + 1) % a.length;  
        heart.style.cssText = "position: fixed;left:-100%;"; // 初始位置  

        var f = 16, // 字体大小  
            x = event.clientX - f / 2, // 横坐标  
            y = event.clientY - f, // 纵坐标  
            c = randomColor(), // 随机颜色  
            a = 1, // 透明度  
            s = 1.2; // 放大缩小比例  

        var timer = setInterval(function () { // 添加定时器  
            if (a <= 0) {  
                document.body.removeChild(heart);  
                clearInterval(timer);  
            } else {  
                heart.style.cssText = "font-size:" + f + "px;cursor: default;position: fixed;color:" +  
                    c + ";left:" + x + "px;top:" + y + "px;opacity:" + a + ";transform:scale(" +  
                    s + ");";  

                y--;  
                a -= 0.016;  
                s += 0.002;  
            }  
        }, 15);  
    }  

    // 随机颜色函数  
    function randomColor() {  
        //- return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + ")";  
        return "(255,240,245)";
    }  
}());</script><div class="loading" style="opacity: 0;"><div class="loadingBar left"></div><div class="loadingBar right"></div></div><main><header class="closed"><div class="navBtn"><i class="navBtnIcon"><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span><span class="navBtnIconBar"></span></i></div><nav><div class="navItem" id="search-header"><span class="navItemTitle"><input autocomplete="off" autocorrect="off" autocapitalize="none" placeholder="Search" spellcheck="false" maxlength="50" type="text" id="search-input"></span></div><div class="navItem" id="search-holder"></div><div class="search-popup" tabindex="0"><div id="search-result"></div></div><ol class="navContent"><li class="navItem"><a class="navBlock" href="/"><span class="navItemTitle">首页</span></a></li><li class="navItem"><a class="navBlock" href="/about"><span class="navItemTitle">关于</span></a></li><li class="navItem" matchdata="categories,tags"><a class="navBlock" href="/archives/"><span class="navItemTitle">归档</span></a></li><li class="navItem"><a class="navBlock" href="/chat-zenith"><span class="navItemTitle">AI</span></a></li></ol></nav></header><article><div id="post-bg"><div id="post-title"><h1>R语言</h1><div id="post-info"><span>First Post: <div class="control"><time datetime="2025-09-14T06:00:00.000Z" id="date"> 2025-09-14</time></div></span><br><span>Last Update: <div class="control"><time datetime="2025-09-18T12:13:21.850Z" id="updated"> 2025-09-18</time></div></span><br><span>Word Count: <div class="control">7.3k</div></span><br><span>Read Time: <div class="control">35 min</div></span></div></div><hr><div id="post-content"><p>R语言是一种编程语言和环境，专门用于统计计算和图形绘制。它是“引擎”，负责执行所有计算任务。</p>
<p>为了有更好的编写R语言的体验，我们可以下载RStudio，它是一个**集成开发环境 (IDE)**。它本身不执行计算，而是为 R 提供一个更好用、更强大的用户界面，包含代码编辑器、调试工具、图形显示窗口等，让你用 R 编程更加高效舒适。</p>
<p>首先先从安装R以及RStudio开始吧</p>
<h2 id="安装R语言"><a href="#安装R语言" class="headerlink" title="安装R语言"></a>安装R语言</h2><p>访问 <a target="_blank" rel="noopener" href="https://cran.r-project.org/">官网</a> <a target="_blank" rel="noopener" href="https://cran.rstudio.com/">The Comprehensive R Archive Network</a></p>
<p>根据你的操作系统选择下载安装程序，这里以windows为例</p>
<p>点击页首的 <strong>“Download R for Windows”</strong>。</p>
<p>点击 <strong>“install R for the first time”</strong> （首次安装 R）。</p>
<p>点击页面顶部的 <strong>“Download R X.X.X for Windows”</strong> （X.X.X 是当前最新版本号）开始下载安装程序（一个 <code>.exe</code> 文件）。</p>
<p>双击下载好的 <code>.exe</code> 文件。</p>
<p>安装过程中基本一直点击 <strong>“下一步”</strong> 即可，所有默认设置对新手都很友好。</p>
<p>语言选择：可以选择中文，也可以使用英文。</p>
<p>安装位置：不建议更改，使用默认路径 <code>C:\Program Files\R\</code>。</p>
<p>组件选择：保持全选默认状态。</p>
<p>启动选项：选择“No（接受自定义）”即可。</p>
<p>完成安装。</p>
<p>可以在系统变量路径中添加 bin 路径就可以全局使用 R 了</p>
<h2 id="安装RStudio"><a href="#安装RStudio" class="headerlink" title="安装RStudio"></a>安装RStudio</h2><p>安装完 R 之后，再来安装更好用的界面 RStudio。</p>
<p>访问 <a href="">RStudio 官网</a></p>
<p>选择对应操作系统的安装程序，点击 <strong>“Download RStudio Desktop for windows”</strong></p>
<p>双击下载的 <code>.exe</code> 文件，同样一路“下一步”即可，无需更改默认设置。</p>
<p>启动 RStudio，会自动匹配到你安装好的R，如果找不到，你也可以手动关联</p>
<p>之后就能在Console中编写代码来测试环境是否配置完成了</p>
<h2 id="下载ISLR2数据集"><a href="#下载ISLR2数据集" class="headerlink" title="下载ISLR2数据集"></a>下载ISLR2数据集</h2><p>建议您访问书籍的<a target="_blank" rel="noopener" href="https://www.statlearning.com/">官方网站</a>，上面有最权威的下载链接和安装指南</p>
<p>在网站上，你可以找到：</p>
<ol>
<li>电子书下载（免费）。</li>
<li>实验手册（Labs）的R和Python代码。</li>
<li>数据集的直接下载链接（如果需要手动下载）。</li>
<li>以及其他更新信息。</li>
</ol>
<p>你也可以编写R语言来通过命令下载ISLR2数据集：</p>
<p>选择File&gt;New File&gt;R Script新建一个文件，在其中编写代码如下：</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs R">install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ISLR2&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ISLR2<span class="hljs-punctuation">)</span><br>data<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<p>选中代码，点击右上角的Run，运行成功后会显示R data sets，内容如下：</p>
<figure class="highlight tex"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br></pre></td><td class="code"><pre><code class="hljs tex">Data sets in package ‘datasets’:<br><br>AirPassengers        Monthly Airline Passenger Numbers<br>                     1949-1960<br>BJsales              Sales Data with Leading Indicator<br>BJsales.lead (BJsales)<br>                     Sales Data with Leading Indicator<br>BOD                  Biochemical Oxygen Demand<br>CO2                  Carbon Dioxide Uptake in Grass Plants<br>ChickWeight          Weight versus age of chicks on different<br>                     diets<br>DNase                Elisa assay of DNase<br>EuStockMarkets       Daily Closing Prices of Major European<br>                     Stock Indices, 1991-1998<br>Formaldehyde         Determination of Formaldehyde<br>HairEyeColor         Hair and Eye Color of Statistics Students<br>Harman23.cor         Harman Example 2.3<br>Harman74.cor         Harman Example 7.4<br>Indometh             Pharmacokinetics of Indomethacin<br>InsectSprays         Effectiveness of Insect Sprays<br>JohnsonJohnson       Quarterly Earnings per Johnson <span class="hljs-built_in">&amp;</span> Johnson<br>                     Share<br>LakeHuron            Level of Lake Huron 1875-1972<br>LifeCycleSavings     Intercountry Life-Cycle Savings Data<br>Loblolly             Growth of Loblolly Pine Trees<br>Nile                 Flow of the River Nile<br>Orange               Growth of Orange Trees<br>OrchardSprays        Potency of Orchard Sprays<br>PlantGrowth          Results from an Experiment on Plant Growth<br>Puromycin            Reaction Velocity of an Enzymatic Reaction<br>Seatbelts            Road Casualties in Great Britain 1969-84<br>Theoph               Pharmacokinetics of Theophylline<br>Titanic              Survival of passengers on the Titanic<br>ToothGrowth          The Effect of Vitamin C on Tooth Growth in<br>                     Guinea Pigs<br>UCBAdmissions        Student Admissions at UC Berkeley<br>UKDriverDeaths       Road Casualties in Great Britain 1969-84<br>UKgas                UK Quarterly Gas Consumption<br>USAccDeaths          Accidental Deaths in the US 1973-1978<br>USArrests            Violent Crime Rates by US State<br>USJudgeRatings       Lawyers&#x27; Ratings of State Judges in the US<br>                     Superior Court<br>USPersonalExpenditure<br>                     Personal Expenditure Data<br>UScitiesD            Distances Between European Cities and<br>                     Between US Cities<br>VADeaths             Death Rates in Virginia (1940)<br>WWWusage             Internet Usage per Minute<br>WorldPhones          The World&#x27;s Telephones<br>ability.cov          Ability and Intelligence Tests<br>airmiles             Passenger Miles on Commercial US Airlines,<br>                     1937-1960<br>airquality           New York Air Quality Measurements<br>anscombe             Anscombe&#x27;s Quartet of &#x27;Identical&#x27; Simple<br>                     Linear Regressions<br>attenu               The Joyner-Boore Attenuation Data<br>attitude             The Chatterjee-Price Attitude Data<br>austres              Quarterly Time Series of the Number of<br>                     Australian Residents<br>beaver1 (beavers)    Body Temperature Series of Two Beavers<br>beaver2 (beavers)    Body Temperature Series of Two Beavers<br>cars                 Speed and Stopping Distances of Cars<br>chickwts             Chicken Weights by Feed Type<br>co2                  Mauna Loa Atmospheric CO2 Concentration<br>crimtab              Student&#x27;s 3000 Criminals Data<br>discoveries          Yearly Numbers of Important Discoveries<br>esoph                Smoking, Alcohol and (O)esophageal Cancer<br>euro                 Conversion Rates of Euro Currencies<br>euro.cross (euro)    Conversion Rates of Euro Currencies<br>eurodist             Distances Between European Cities and<br>                     Between US Cities<br>faithful             Old Faithful Geyser Data<br>fdeaths (UKLungDeaths)<br>                     Monthly Deaths from Lung Diseases in the<br>                     UK<br>freeny               Freeny&#x27;s Revenue Data<br>freeny.x (freeny)    Freeny&#x27;s Revenue Data<br>freeny.y (freeny)    Freeny&#x27;s Revenue Data<br>gait                 Hip and Knee Angle while Walking<br>infert               Infertility after Spontaneous and Induced<br>                     Abortion<br>iris                 Edgar Anderson&#x27;s Iris Data<br>iris3                Edgar Anderson&#x27;s Iris Data<br>islands              Areas of the World&#x27;s Major Landmasses<br>ldeaths (UKLungDeaths)<br>                     Monthly Deaths from Lung Diseases in the<br>                     UK<br>lh                   Luteinizing Hormone in Blood Samples<br>longley              Longley&#x27;s Economic Regression Data<br>lynx                 Annual Canadian Lynx trappings 1821-1934<br>mdeaths (UKLungDeaths)<br>                     Monthly Deaths from Lung Diseases in the<br>                     UK<br>morley               Michelson Speed of Light Data<br>mtcars               Motor Trend Car Road Tests<br>nhtemp               Average Yearly Temperatures in New Haven<br>nottem               Average Monthly Temperatures at<br>                     Nottingham, 1920-1939<br>npk                  Classical N, P, K Factorial Experiment<br>occupationalStatus   Occupational Status of Fathers and their<br>                     Sons<br>penguins             Measurements of Penguins near Palmer<br>                     Station, Antarctica<br>penguins<span class="hljs-built_in">_</span>raw (penguins)<br>                     Measurements of Penguins near Palmer<br>                     Station, Antarctica<br>precip               Annual Precipitation in Selected US Cities<br>presidents           Quarterly Approval Ratings of US<br>                     Presidents<br>pressure             Vapor Pressure of Mercury as a Function of<br>                     Temperature<br>quakes               Locations of Earthquakes off Fiji<br>randu                Random Numbers from Congruential Generator<br>                     RANDU<br>rivers               Lengths of Major North American Rivers<br>rock                 Measurements on Petroleum Rock Samples<br>sleep                Student&#x27;s Sleep Data<br>stack.loss (stackloss)<br>                     Brownlee&#x27;s Stack Loss Plant Data<br>stack.x (stackloss)<br>                     Brownlee&#x27;s Stack Loss Plant Data<br>stackloss            Brownlee&#x27;s Stack Loss Plant Data<br>state.abb (state)    US State Facts and Figures<br>state.area (state)   US State Facts and Figures<br>state.center (state)<br>                     US State Facts and Figures<br>state.division (state)<br>                     US State Facts and Figures<br>state.name (state)   US State Facts and Figures<br>state.region (state)<br>                     US State Facts and Figures<br>state.x77 (state)    US State Facts and Figures<br>sunspot.m2014 (sunspot.month)<br>                     Monthly Sunspot Data, from 1749 to<br>                     &quot;Present&quot;<br>sunspot.month        Monthly Sunspot Data, from 1749 to<br>                     &quot;Present&quot;<br>sunspot.year         Yearly Sunspot Data, 1700-1988<br>sunspots             Monthly Sunspot Numbers, 1749-1983<br>swiss                Swiss Fertility and Socioeconomic<br>                     Indicators (1888) Data<br>treering             Yearly Tree-Ring Data, -6000-1979<br>trees                Diameter, Height and Volume for Black<br>                     Cherry Trees<br>uspop                Populations Recorded by the US Census<br>volcano              Topographic Information on Auckland&#x27;s<br>                     Maunga Whau Volcano<br>warpbreaks           The Number of Breaks in Yarn during<br>                     Weaving<br>women                Average Heights and Weights for American<br>                     Women<br><br>Data sets in package ‘ISLR2’:<br><br>Auto                 Auto Data Set<br>Bikeshare            Bike sharing data<br>Boston               Boston Data<br>BrainCancer          Brain Cancer Data<br>Caravan              The Insurance Company (TIC) Benchmark<br>Carseats             Sales of Child Car Seats<br>College              U.S. News and World Report&#x27;s College Data<br>Credit               Credit Card Balance Data<br>Default              Credit Card Default Data<br>Fund                 Fund Manager Data<br>Hitters              Baseball Data<br>Khan                 Khan Gene Data<br>NCI60                NCI 60 Data<br>NYSE                 New York Stock Exchange Data<br>OJ                   Orange Juice Data<br>Portfolio            Portfolio Data<br>Publication          Time-to-Publication Data<br>Smarket              S<span class="hljs-built_in">&amp;</span>P Stock Market Data<br>Wage                 Mid-Atlantic Wage Data<br>Weekly               Weekly S<span class="hljs-built_in">&amp;</span>P Stock Market Data<br><br><br>Use ‘data(package = .packages(all.available = TRUE))’<br>to list the data sets in all *available* packages.<br></code></pre></td></tr></table></figure>

<p>这个列表中包含书中使用的所有经典数据集，如 <code>Auto</code>, <code>Boston</code>, <code>Carseats</code>, <code>Credit</code>, <code>Wage</code> 等。</p>
<h2 id="R语言基础"><a href="#R语言基础" class="headerlink" title="R语言基础"></a>R语言基础</h2><p>现在让我们开始学习R语言的基础知识。R语言就像一个强大的计算器，但它能做的远不止简单运算。我们将从最基本的概念开始，逐步建立起对R语言的理解。</p>
<h3 id="1-R作为计算器"><a href="#1-R作为计算器" class="headerlink" title="1. R作为计算器"></a>1. R作为计算器</h3><p>打开RStudio，在Console窗口中，你可以直接输入数学表达式。R会立即计算并返回结果。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 基本算术运算</span><br><span class="hljs-number">2</span> <span class="hljs-operator">+</span> <span class="hljs-number">3</span>        <span class="hljs-comment"># 加法：返回 5</span><br><span class="hljs-number">10</span> <span class="hljs-operator">-</span> <span class="hljs-number">4</span>       <span class="hljs-comment"># 减法：返回 6</span><br><span class="hljs-number">3</span> <span class="hljs-operator">*</span> <span class="hljs-number">4</span>        <span class="hljs-comment"># 乘法：返回 12</span><br><span class="hljs-number">15</span> <span class="hljs-operator">/</span> <span class="hljs-number">3</span>       <span class="hljs-comment"># 除法：返回 5</span><br><span class="hljs-number">2</span><span class="hljs-operator">^</span><span class="hljs-number">3</span>          <span class="hljs-comment"># 幂运算：2的3次方，返回 8</span><br><span class="hljs-number">17</span> <span class="hljs-operator">%%</span> <span class="hljs-number">5</span>      <span class="hljs-comment"># 取余数：17除以5的余数，返回 2</span><br><span class="hljs-number">17</span> <span class="hljs-operator">%/%</span> <span class="hljs-number">5</span>     <span class="hljs-comment"># 整除：17除以5的商，返回 3</span><br><br><span class="hljs-comment"># 数学函数</span><br><span class="hljs-built_in">sqrt</span><span class="hljs-punctuation">(</span><span class="hljs-number">16</span><span class="hljs-punctuation">)</span>     <span class="hljs-comment"># 平方根：返回 4</span><br><span class="hljs-built_in">abs</span><span class="hljs-punctuation">(</span><span class="hljs-operator">-</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span>      <span class="hljs-comment"># 绝对值：返回 5</span><br><span class="hljs-built_in">exp</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span>       <span class="hljs-comment"># e的1次方：返回 2.718282</span><br><span class="hljs-built_in">log</span><span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span>      <span class="hljs-comment"># 自然对数：返回 2.302585</span><br>log10<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span>   <span class="hljs-comment"># 以10为底的对数：返回 2</span><br></code></pre></td></tr></table></figure>

<h3 id="2-变量和赋值"><a href="#2-变量和赋值" class="headerlink" title="2. 变量和赋值"></a>2. 变量和赋值</h3><p>在R中，我们使用箭头 <code>&lt;-</code> 或等号 <code>=</code> 来给变量赋值。箭头是R的传统写法，更受推荐，因为它清楚地表示了”将右边的值赋给左边的变量”这个方向性。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建变量</span><br>x <span class="hljs-operator">&lt;-</span> 5                    <span class="hljs-comment"># 将5赋值给变量x</span><br>y <span class="hljs-operator">&lt;-</span> 10                   <span class="hljs-comment"># 将10赋值给变量y</span><br>result <span class="hljs-operator">&lt;-</span> x <span class="hljs-operator">+</span> y           <span class="hljs-comment"># 将x和y的和赋值给result</span><br>print<span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">)</span>             <span class="hljs-comment"># 显示result的值：15</span><br><br><span class="hljs-comment"># 变量命名规则</span><br>my_variable <span class="hljs-operator">&lt;-</span> 100        <span class="hljs-comment"># 使用下划线</span><br>myVariable <span class="hljs-operator">&lt;-</span> 200         <span class="hljs-comment"># 使用驼峰命名法</span><br>data.2024 <span class="hljs-operator">&lt;-</span> 300         <span class="hljs-comment"># 可以包含点和数字</span><br><span class="hljs-comment"># 2data &lt;- 400            # 错误！不能以数字开头</span><br><span class="hljs-comment"># my-var &lt;- 500           # 错误！不能使用连字符</span><br><br><span class="hljs-comment"># 查看和管理变量</span><br>ls<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>                      <span class="hljs-comment"># 列出当前环境中的所有变量</span><br>rm<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span>                     <span class="hljs-comment"># 删除变量x</span><br>rm<span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span> <span class="hljs-operator">=</span> ls<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>           <span class="hljs-comment"># 清空所有变量（慎用）</span><br></code></pre></td></tr></table></figure>

<h3 id="3-数据类型"><a href="#3-数据类型" class="headerlink" title="3. 数据类型"></a>3. 数据类型</h3><p>R有几种基本的数据类型，理解它们是掌握R语言的关键。每种类型都有其特定用途。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 数值型（numeric）- 用于存储数字</span><br>age <span class="hljs-operator">&lt;-</span> 25                 <br>height <span class="hljs-operator">&lt;-</span> 175.5           <br><span class="hljs-built_in">class</span><span class="hljs-punctuation">(</span>age<span class="hljs-punctuation">)</span>                <span class="hljs-comment"># 查看类型：&quot;numeric&quot;</span><br><br><span class="hljs-comment"># 字符型（character）- 用于存储文本</span><br>name <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;张三&quot;</span>            <br>city <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&#x27;Beijing&#x27;</span>         <span class="hljs-comment"># 单引号或双引号都可以</span><br><span class="hljs-built_in">class</span><span class="hljs-punctuation">(</span>name<span class="hljs-punctuation">)</span>               <span class="hljs-comment"># 返回 &quot;character&quot;</span><br><br><span class="hljs-comment"># 逻辑型（logical）- 用于存储真/假值</span><br>is_student <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">TRUE</span>        <span class="hljs-comment"># 或写作 T</span><br>is_married <span class="hljs-operator">&lt;-</span> <span class="hljs-literal">FALSE</span>       <span class="hljs-comment"># 或写作 F</span><br><span class="hljs-built_in">class</span><span class="hljs-punctuation">(</span>is_student<span class="hljs-punctuation">)</span>         <span class="hljs-comment"># 返回 &quot;logical&quot;</span><br><br><span class="hljs-comment"># 类型转换</span><br>num_str <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;123&quot;</span>          <span class="hljs-comment"># 这是字符串</span><br>num_val <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>num_str<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 转换为数值：123</span><br>str_val <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.character</span><span class="hljs-punctuation">(</span><span class="hljs-number">456</span><span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 数值转字符串：&quot;456&quot;</span><br>bool_val <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.logical</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">)</span>       <span class="hljs-comment"># 1转为TRUE，0转为FALSE</span><br><br><span class="hljs-comment"># 检查数据类型</span><br><span class="hljs-built_in">is.numeric</span><span class="hljs-punctuation">(</span>age<span class="hljs-punctuation">)</span>           <span class="hljs-comment"># 返回 TRUE</span><br><span class="hljs-built_in">is.character</span><span class="hljs-punctuation">(</span>name<span class="hljs-punctuation">)</span>        <span class="hljs-comment"># 返回 TRUE</span><br><span class="hljs-built_in">is.logical</span><span class="hljs-punctuation">(</span>is_student<span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 返回 TRUE</span><br></code></pre></td></tr></table></figure>

<h3 id="4-向量（Vector）"><a href="#4-向量（Vector）" class="headerlink" title="4. 向量（Vector）"></a>4. 向量（Vector）</h3><p>向量是R中最基本的数据结构，可以理解为一组相同类型元素的有序集合。在R中，即使单个数值也被视为长度为1的向量。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建向量</span><br>numbers <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span>     <span class="hljs-comment"># c()函数用于组合元素</span><br>fruits <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;apple&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;banana&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;orange&quot;</span><span class="hljs-punctuation">)</span><br>scores <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">85</span><span class="hljs-punctuation">,</span> <span class="hljs-number">92</span><span class="hljs-punctuation">,</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span> <span class="hljs-number">95</span><span class="hljs-punctuation">,</span> <span class="hljs-number">88</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 创建序列</span><br>seq1 <span class="hljs-operator">&lt;-</span> 1<span class="hljs-operator">:</span><span class="hljs-number">10</span>                     <span class="hljs-comment"># 创建1到10的整数序列</span><br>seq2 <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span> by<span class="hljs-operator">=</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span>      <span class="hljs-comment"># 从0到100，步长为10</span><br>seq3 <span class="hljs-operator">&lt;-</span> seq<span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> length.out<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># 从0到1，等分为5个数</span><br><br><span class="hljs-comment"># 重复元素</span><br>rep1 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">0</span><span class="hljs-punctuation">,</span> times<span class="hljs-operator">=</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span>          <span class="hljs-comment"># 将0重复5次：0 0 0 0 0</span><br>rep2 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> times<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span>     <span class="hljs-comment"># 重复整个向量3次：1 2 1 2 1 2</span><br>rep3 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> each<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span>      <span class="hljs-comment"># 每个元素重复3次：1 1 1 2 2 2</span><br><br><span class="hljs-comment"># 向量运算（向量化运算是R的强大特性）</span><br>v1 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">)</span><br>v2 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">6</span><span class="hljs-punctuation">,</span> <span class="hljs-number">7</span><span class="hljs-punctuation">,</span> <span class="hljs-number">8</span><span class="hljs-punctuation">)</span><br>v1 <span class="hljs-operator">+</span> v2                          <span class="hljs-comment"># 对应元素相加：6 8 10 12</span><br>v1 <span class="hljs-operator">*</span> <span class="hljs-number">2</span>                           <span class="hljs-comment"># 每个元素乘以2：2 4 6 8</span><br>v1 <span class="hljs-operator">&gt;</span> <span class="hljs-number">2</span>                           <span class="hljs-comment"># 返回逻辑向量：FALSE FALSE TRUE TRUE</span><br><br><span class="hljs-comment"># 访问向量元素</span><br>scores<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span>                        <span class="hljs-comment"># 第1个元素（R从1开始计数）：85</span><br>scores<span class="hljs-punctuation">[</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span>              <span class="hljs-comment"># 第1、3、5个元素：85 78 88</span><br>scores<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">]</span>                      <span class="hljs-comment"># 第2到第4个元素：92 78 95</span><br>scores<span class="hljs-punctuation">[</span><span class="hljs-operator">-</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span>                       <span class="hljs-comment"># 除了第2个元素外的所有元素</span><br>scores<span class="hljs-punctuation">[</span>scores <span class="hljs-operator">&gt;</span> <span class="hljs-number">90</span><span class="hljs-punctuation">]</span>             <span class="hljs-comment"># 条件筛选：大于90的分数</span><br><br><span class="hljs-comment"># 向量的基本函数</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 向量长度：5</span><br><span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                      <span class="hljs-comment"># 求和：438</span><br>mean<span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                     <span class="hljs-comment"># 平均值：87.6</span><br>median<span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 中位数：88</span><br>sd<span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                       <span class="hljs-comment"># 标准差：6.580274</span><br><span class="hljs-built_in">min</span><span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                      <span class="hljs-comment"># 最小值：78</span><br><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>scores<span class="hljs-punctuation">)</span>                      <span class="hljs-comment"># 最大值：95</span><br></code></pre></td></tr></table></figure>

<h3 id="5-矩阵（Matrix）"><a href="#5-矩阵（Matrix）" class="headerlink" title="5. 矩阵（Matrix）"></a>5. 矩阵（Matrix）</h3><p>矩阵是二维的数据结构，所有元素必须是相同类型。在统计分析中，矩阵运算非常重要。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建矩阵</span><br><span class="hljs-comment"># 方法1：使用matrix函数</span><br>mat1 <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> ncol<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 3行4列，按列填充</span><br>mat2 <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> ncol<span class="hljs-operator">=</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> byrow<span class="hljs-operator">=</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 按行填充</span><br><br><span class="hljs-comment"># 方法2：组合向量</span><br>vec1 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>vec2 <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">6</span><span class="hljs-punctuation">)</span><br>mat3 <span class="hljs-operator">&lt;-</span> cbind<span class="hljs-punctuation">(</span>vec1<span class="hljs-punctuation">,</span> vec2<span class="hljs-punctuation">)</span>       <span class="hljs-comment"># 按列组合</span><br>mat4 <span class="hljs-operator">&lt;-</span> rbind<span class="hljs-punctuation">(</span>vec1<span class="hljs-punctuation">,</span> vec2<span class="hljs-punctuation">)</span>       <span class="hljs-comment"># 按行组合</span><br><br><span class="hljs-comment"># 矩阵属性</span><br><span class="hljs-built_in">dim</span><span class="hljs-punctuation">(</span>mat1<span class="hljs-punctuation">)</span>                        <span class="hljs-comment"># 维度：3 4</span><br>nrow<span class="hljs-punctuation">(</span>mat1<span class="hljs-punctuation">)</span>                       <span class="hljs-comment"># 行数：3</span><br>ncol<span class="hljs-punctuation">(</span>mat1<span class="hljs-punctuation">)</span>                       <span class="hljs-comment"># 列数：4</span><br><br><span class="hljs-comment"># 访问矩阵元素</span><br>mat1<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">]</span>                       <span class="hljs-comment"># 第2行第3列的元素</span><br>mat1<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">]</span>                        <span class="hljs-comment"># 第2行的所有元素</span><br>mat1<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">]</span>                        <span class="hljs-comment"># 第3列的所有元素</span><br>mat1<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span>                   <span class="hljs-comment"># 第1-2行，第2-3列的子矩阵</span><br><br><span class="hljs-comment"># 矩阵运算</span><br>A <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>B <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><span class="hljs-number">7</span><span class="hljs-punctuation">,</span><span class="hljs-number">8</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>A <span class="hljs-operator">+</span> B                            <span class="hljs-comment"># 元素对应相加</span><br>A <span class="hljs-operator">*</span> B                            <span class="hljs-comment"># 元素对应相乘（不是矩阵乘法）</span><br>A <span class="hljs-operator">%*%</span> B                          <span class="hljs-comment"># 矩阵乘法</span><br>t<span class="hljs-punctuation">(</span>A<span class="hljs-punctuation">)</span>                             <span class="hljs-comment"># 转置</span><br>solve<span class="hljs-punctuation">(</span>A<span class="hljs-punctuation">)</span>                         <span class="hljs-comment"># 求逆矩阵（如果存在）</span><br></code></pre></td></tr></table></figure>

<h3 id="6-数据框（Data-Frame）"><a href="#6-数据框（Data-Frame）" class="headerlink" title="6. 数据框（Data Frame）"></a>6. 数据框（Data Frame）</h3><p>数据框是R中最重要的数据结构之一，类似于Excel表格。它可以存储不同类型的数据，每列可以是不同的数据类型，但每列内的数据类型必须相同。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建数据框</span><br>student_data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  name <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Alice&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Bob&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Charlie&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;David&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  age <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span> <span class="hljs-number">21</span><span class="hljs-punctuation">,</span> <span class="hljs-number">19</span><span class="hljs-punctuation">,</span> <span class="hljs-number">22</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  score <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">85</span><span class="hljs-punctuation">,</span> <span class="hljs-number">92</span><span class="hljs-punctuation">,</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span> <span class="hljs-number">95</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  passed <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 查看数据框</span><br>print<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">)</span>              <span class="hljs-comment"># 显示整个数据框</span><br>head<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span>            <span class="hljs-comment"># 显示前2行</span><br>tail<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span>            <span class="hljs-comment"># 显示后2行</span><br>str<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">)</span>                <span class="hljs-comment"># 显示结构信息</span><br>summary<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">)</span>            <span class="hljs-comment"># 显示统计摘要</span><br><br><span class="hljs-comment"># 访问数据框</span><br>student_data<span class="hljs-operator">$</span>name                <span class="hljs-comment"># 访问name列（返回向量）</span><br>student_data<span class="hljs-punctuation">[</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;score&quot;</span><span class="hljs-punctuation">]</span>          <span class="hljs-comment"># 另一种访问列的方式</span><br>student_data<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">]</span>                 <span class="hljs-comment"># 第2行</span><br>student_data<span class="hljs-punctuation">[</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">]</span>                <span class="hljs-comment"># 第2行第3列</span><br>student_data<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;age&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span>  <span class="hljs-comment"># 前2行的name和age列</span><br><br><span class="hljs-comment"># 条件筛选</span><br>student_data<span class="hljs-punctuation">[</span>student_data<span class="hljs-operator">$</span>age <span class="hljs-operator">&gt;</span> <span class="hljs-number">20</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">]</span>     <span class="hljs-comment"># 年龄大于20的所有行</span><br>student_data<span class="hljs-punctuation">[</span>student_data<span class="hljs-operator">$</span>passed <span class="hljs-operator">==</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">]</span>  <span class="hljs-comment"># 通过考试的学生姓名</span><br><br><span class="hljs-comment"># 添加新列</span><br>student_data<span class="hljs-operator">$</span>grade <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;C&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 添加成绩等级列</span><br>student_data<span class="hljs-operator">$</span>age_group <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>student_data<span class="hljs-operator">$</span>age <span class="hljs-operator">&gt;=</span> <span class="hljs-number">21</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Adult&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Young&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 修改数据</span><br>student_data<span class="hljs-operator">$</span>score<span class="hljs-punctuation">[</span><span class="hljs-number">3</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-number">80</span>      <span class="hljs-comment"># 修改第3个学生的分数</span><br>student_data<span class="hljs-punctuation">[</span>student_data<span class="hljs-operator">$</span>name <span class="hljs-operator">==</span> <span class="hljs-string">&quot;Bob&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;age&quot;</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-number">22</span>  <span class="hljs-comment"># 修改Bob的年龄</span><br></code></pre></td></tr></table></figure>

<h3 id="7-列表（List）"><a href="#7-列表（List）" class="headerlink" title="7. 列表（List）"></a>7. 列表（List）</h3><p>列表是R中最灵活的数据结构，可以包含任何类型的元素，包括向量、矩阵、数据框，甚至其他列表。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建列表</span><br>my_list <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><br>  numbers <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;R Programming&quot;</span><span class="hljs-punctuation">,</span><br>  matrix <span class="hljs-operator">=</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">4</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-operator">=</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  data <span class="hljs-operator">=</span> student_data<br><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 访问列表元素</span><br>my_list<span class="hljs-operator">$</span>numbers                  <span class="hljs-comment"># 使用$符号</span><br>my_list<span class="hljs-punctuation">[[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span>                      <span class="hljs-comment"># 使用双方括号（返回元素本身）</span><br>my_list<span class="hljs-punctuation">[</span><span class="hljs-number">1</span><span class="hljs-punctuation">]</span>                        <span class="hljs-comment"># 使用单方括号（返回子列表）</span><br>my_list<span class="hljs-punctuation">[[</span><span class="hljs-string">&quot;name&quot;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span>                <span class="hljs-comment"># 使用名称访问</span><br><br><span class="hljs-comment"># 添加或修改元素</span><br>my_list<span class="hljs-operator">$</span>new_element <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;New&quot;</span>     <span class="hljs-comment"># 添加新元素</span><br>my_list<span class="hljs-punctuation">[[</span><span class="hljs-number">2</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;Updated Name&quot;</span>   <span class="hljs-comment"># 修改第2个元素</span><br><br><span class="hljs-comment"># 列表长度和名称</span><br><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>my_list<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 列表中元素的个数</span><br><span class="hljs-built_in">names</span><span class="hljs-punctuation">(</span>my_list<span class="hljs-punctuation">)</span>                    <span class="hljs-comment"># 元素的名称</span><br></code></pre></td></tr></table></figure>

<h2 id="控制结构"><a href="#控制结构" class="headerlink" title="控制结构"></a>控制结构</h2><p>控制结构让我们能够控制代码的执行流程，这是编程的核心概念之一。</p>
<h3 id="1-条件语句"><a href="#1-条件语句" class="headerlink" title="1. 条件语句"></a>1. 条件语句</h3><p>条件语句让程序可以根据不同的条件执行不同的代码。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># if语句</span><br>score <span class="hljs-operator">&lt;-</span> 85<br><span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>score <span class="hljs-operator">&gt;=</span> <span class="hljs-number">90</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;优秀&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>score <span class="hljs-operator">&gt;=</span> <span class="hljs-number">80</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;良好&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>score <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;及格&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;不及格&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># ifelse函数（向量化的条件判断）</span><br>scores <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">85</span><span class="hljs-punctuation">,</span> <span class="hljs-number">92</span><span class="hljs-punctuation">,</span> <span class="hljs-number">78</span><span class="hljs-punctuation">,</span> <span class="hljs-number">95</span><span class="hljs-punctuation">,</span> <span class="hljs-number">58</span><span class="hljs-punctuation">)</span><br>grades <span class="hljs-operator">&lt;-</span> ifelse<span class="hljs-punctuation">(</span>scores <span class="hljs-operator">&gt;=</span> <span class="hljs-number">90</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span><br>          ifelse<span class="hljs-punctuation">(</span>scores <span class="hljs-operator">&gt;=</span> <span class="hljs-number">80</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <br>          ifelse<span class="hljs-punctuation">(</span>scores <span class="hljs-operator">&gt;=</span> <span class="hljs-number">70</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;C&quot;</span><span class="hljs-punctuation">,</span><br>          ifelse<span class="hljs-punctuation">(</span>scores <span class="hljs-operator">&gt;=</span> <span class="hljs-number">60</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;D&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;F&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>grades<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># &quot;B&quot; &quot;A&quot; &quot;C&quot; &quot;A&quot; &quot;F&quot;</span><br><br><span class="hljs-comment"># switch语句（多分支选择）</span><br>day <span class="hljs-operator">&lt;-</span> 3<br>day_name <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">switch</span><span class="hljs-punctuation">(</span>day<span class="hljs-punctuation">,</span><br>  <span class="hljs-string">&quot;Monday&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Tuesday&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Wednesday&quot;</span><span class="hljs-punctuation">,</span> <br>  <span class="hljs-string">&quot;Thursday&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Friday&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Saturday&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Sunday&quot;</span><br><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>day_name<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># &quot;Wednesday&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="2-循环结构"><a href="#2-循环结构" class="headerlink" title="2. 循环结构"></a>2. 循环结构</h3><p>循环让我们可以重复执行某段代码，这在处理大量数据时特别有用。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># for循环</span><br><span class="hljs-comment"># 示例1：遍历向量</span><br>fruits <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;apple&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;banana&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;orange&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>fruit <span class="hljs-keyword">in</span> fruits<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;I like&quot;</span><span class="hljs-punctuation">,</span> fruit<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># paste函数用于连接字符串</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 示例2：使用序列</span><br>total <span class="hljs-operator">&lt;-</span> 0<br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  total <span class="hljs-operator">&lt;-</span> total <span class="hljs-operator">+</span> i  <span class="hljs-comment"># 累加1到10</span><br><span class="hljs-punctuation">&#125;</span><br>print<span class="hljs-punctuation">(</span>total<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 55</span><br><br><span class="hljs-comment"># 示例3：遍历数据框</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>nrow<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  cat<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Student:&quot;</span><span class="hljs-punctuation">,</span> student_data<span class="hljs-operator">$</span>name<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <br>      <span class="hljs-string">&quot;Score:&quot;</span><span class="hljs-punctuation">,</span> student_data<span class="hljs-operator">$</span>score<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;\n&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># while循环</span><br>count <span class="hljs-operator">&lt;-</span> 1<br><span class="hljs-keyword">while</span> <span class="hljs-punctuation">(</span>count <span class="hljs-operator">&lt;=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Count is&quot;</span><span class="hljs-punctuation">,</span> count<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>  count <span class="hljs-operator">&lt;-</span> count <span class="hljs-operator">+</span> <span class="hljs-number">1</span>  <span class="hljs-comment"># 别忘了更新条件，避免无限循环</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># repeat循环（需要使用break跳出）</span><br>x <span class="hljs-operator">&lt;-</span> 1<br><span class="hljs-keyword">repeat</span> <span class="hljs-punctuation">&#123;</span><br>  print<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><br>  x <span class="hljs-operator">&lt;-</span> x <span class="hljs-operator">+</span> <span class="hljs-number">1</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>x <span class="hljs-operator">&gt;</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">break</span>  <span class="hljs-comment"># 当x大于5时跳出循环</span><br>  <span class="hljs-punctuation">&#125;</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 循环控制语句</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>i <span class="hljs-operator">==</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">next</span>  <span class="hljs-comment"># 跳过当前迭代，继续下一次</span><br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>i <span class="hljs-operator">==</span> <span class="hljs-number">8</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    <span class="hljs-keyword">break</span>  <span class="hljs-comment"># 跳出整个循环</span><br>  <span class="hljs-punctuation">&#125;</span><br>  print<span class="hljs-punctuation">(</span>i<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span>  <span class="hljs-comment"># 输出：1 2 3 4 6 7</span><br></code></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>函数是组织代码的基本方式，让我们可以重复使用代码逻辑。R中有大量内置函数，我们也可以创建自己的函数。</p>
<h3 id="1-创建函数"><a href="#1-创建函数" class="headerlink" title="1. 创建函数"></a>1. 创建函数</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 基本函数定义</span><br>calculate_area <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>radius<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  area <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">pi</span> <span class="hljs-operator">*</span> radius<span class="hljs-operator">^</span><span class="hljs-number">2</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>area<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># return可以省略，R会返回最后一个表达式的值</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 使用函数</span><br>circle_area <span class="hljs-operator">&lt;-</span> calculate_area<span class="hljs-punctuation">(</span><span class="hljs-number">5</span><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>circle_area<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 78.53982</span><br><br><span class="hljs-comment"># 带多个参数的函数</span><br>calculate_bmi <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>weight<span class="hljs-punctuation">,</span> height<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-comment"># weight: 体重（kg）</span><br>  <span class="hljs-comment"># height: 身高（m）</span><br>  bmi <span class="hljs-operator">&lt;-</span> weight <span class="hljs-operator">/</span> <span class="hljs-punctuation">(</span>height<span class="hljs-operator">^</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>  <br>  <span class="hljs-comment"># 返回BMI值和健康状况</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>bmi <span class="hljs-operator">&lt;</span> <span class="hljs-number">18.5</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    status <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;偏瘦&quot;</span><br>  <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>bmi <span class="hljs-operator">&lt;</span> <span class="hljs-number">25</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    status <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;正常&quot;</span><br>  <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span>bmi <span class="hljs-operator">&lt;</span> <span class="hljs-number">30</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    status <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;偏胖&quot;</span><br>  <span class="hljs-punctuation">&#125;</span> <span class="hljs-keyword">else</span> <span class="hljs-punctuation">&#123;</span><br>    status <span class="hljs-operator">&lt;-</span> <span class="hljs-string">&quot;肥胖&quot;</span><br>  <span class="hljs-punctuation">&#125;</span><br>  <br>  <span class="hljs-comment"># 返回列表</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>bmi <span class="hljs-operator">=</span> bmi<span class="hljs-punctuation">,</span> status <span class="hljs-operator">=</span> status<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 使用函数</span><br>result <span class="hljs-operator">&lt;-</span> calculate_bmi<span class="hljs-punctuation">(</span><span class="hljs-number">70</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1.75</span><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;BMI:&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">round</span><span class="hljs-punctuation">(</span>result<span class="hljs-operator">$</span>bmi<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># BMI: 22.86</span><br>print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;状态:&quot;</span><span class="hljs-punctuation">,</span> result<span class="hljs-operator">$</span>status<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>        <span class="hljs-comment"># 状态: 正常</span><br><br><span class="hljs-comment"># 带默认参数的函数</span><br>greet <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>name<span class="hljs-punctuation">,</span> greeting <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Hello&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  message <span class="hljs-operator">&lt;-</span> paste<span class="hljs-punctuation">(</span>greeting<span class="hljs-punctuation">,</span> name<span class="hljs-punctuation">)</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>message<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>print<span class="hljs-punctuation">(</span>greet<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Alice&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>                <span class="hljs-comment"># &quot;Hello Alice&quot;</span><br>print<span class="hljs-punctuation">(</span>greet<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Bob&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Good morning&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># &quot;Good morning Bob&quot;</span><br></code></pre></td></tr></table></figure>

<h3 id="2-函数作用域"><a href="#2-函数作用域" class="headerlink" title="2. 函数作用域"></a>2. 函数作用域</h3><p>理解作用域对于编写正确的函数非常重要。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 全局变量 vs 局部变量</span><br>global_var <span class="hljs-operator">&lt;-</span> 100<br><br>test_scope <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  local_var <span class="hljs-operator">&lt;-</span> 50         <span class="hljs-comment"># 局部变量，只在函数内可见</span><br>  global_var <span class="hljs-operator">&lt;-</span> 200       <span class="hljs-comment"># 创建了一个局部变量，不影响全局变量</span><br>  print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;函数内 global_var:&quot;</span><span class="hljs-punctuation">,</span> global_var<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 200</span><br>  print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;函数内 local_var:&quot;</span><span class="hljs-punctuation">,</span> local_var<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 50</span><br><span class="hljs-punctuation">&#125;</span><br><br>test_scope<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;函数外 global_var:&quot;</span><span class="hljs-punctuation">,</span> global_var<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 100</span><br><span class="hljs-comment"># print(local_var)  # 错误！local_var在函数外不存在</span><br><br><span class="hljs-comment"># 使用&lt;&lt;-修改全局变量（慎用）</span><br>modify_global <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  global_var <span class="hljs-operator">&lt;&lt;-</span> <span class="hljs-number">300</span>  <span class="hljs-comment"># 使用&lt;&lt;-修改全局变量</span><br><span class="hljs-punctuation">&#125;</span><br><br>modify_global<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>global_var<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 300</span><br></code></pre></td></tr></table></figure>

<h3 id="3-高阶函数"><a href="#3-高阶函数" class="headerlink" title="3. 高阶函数"></a>3. 高阶函数</h3><p>R支持函数式编程，可以将函数作为参数传递。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># apply系列函数</span><br><span class="hljs-comment"># apply: 对矩阵的行或列应用函数</span><br>mat <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">12</span><span class="hljs-punctuation">,</span> nrow<span class="hljs-operator">=</span><span class="hljs-number">3</span><span class="hljs-punctuation">)</span><br>row_sums <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>mat<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">sum</span><span class="hljs-punctuation">)</span>    <span class="hljs-comment"># 1表示行，计算每行的和</span><br>col_means <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>mat<span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 2表示列，计算每列的平均值</span><br><br><span class="hljs-comment"># lapply: 对列表的每个元素应用函数，返回列表</span><br>numbers_list <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>a <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">5</span><span class="hljs-punctuation">,</span> b <span class="hljs-operator">=</span> <span class="hljs-number">6</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span> <span class="hljs-operator">=</span> <span class="hljs-number">11</span><span class="hljs-operator">:</span><span class="hljs-number">15</span><span class="hljs-punctuation">)</span><br>means_list <span class="hljs-operator">&lt;-</span> lapply<span class="hljs-punctuation">(</span>numbers_list<span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># sapply: 类似lapply，但尝试简化结果为向量或矩阵</span><br>means_vector <span class="hljs-operator">&lt;-</span> sapply<span class="hljs-punctuation">(</span>numbers_list<span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 返回向量</span><br><br><span class="hljs-comment"># tapply: 按分组应用函数</span><br>ages <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">23</span><span class="hljs-punctuation">,</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">27</span><span class="hljs-punctuation">,</span> <span class="hljs-number">22</span><span class="hljs-punctuation">,</span> <span class="hljs-number">24</span><span class="hljs-punctuation">,</span> <span class="hljs-number">26</span><span class="hljs-punctuation">)</span><br>groups <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">)</span><br>group_means <span class="hljs-operator">&lt;-</span> tapply<span class="hljs-punctuation">(</span>ages<span class="hljs-punctuation">,</span> groups<span class="hljs-punctuation">,</span> mean<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 计算每组的平均年龄</span><br></code></pre></td></tr></table></figure>

<h2 id="数据导入与导出"><a href="#数据导入与导出" class="headerlink" title="数据导入与导出"></a>数据导入与导出</h2><p>在实际工作中，我们经常需要从外部文件读取数据或将处理结果保存到文件。</p>
<h3 id="1-CSV文件"><a href="#1-CSV文件" class="headerlink" title="1. CSV文件"></a>1. CSV文件</h3><p>CSV是最常用的数据交换格式之一。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 写入CSV文件</span><br><span class="hljs-comment"># 创建示例数据</span><br>sales_data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  month <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;Jan&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Feb&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Mar&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;Apr&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  revenue <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">10000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">12000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">15000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">13000</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  profit <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">3000</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3500</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4500</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4000</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 保存为CSV</span><br>write.csv<span class="hljs-punctuation">(</span>sales_data<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;sales_2024.csv&quot;</span><span class="hljs-punctuation">,</span> row.names <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 读取CSV文件</span><br>data_from_csv <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;sales_2024.csv&quot;</span><span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>data_from_csv<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 处理更复杂的CSV</span><br><span class="hljs-comment"># 指定分隔符、编码、缺失值等</span><br>data <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;data.csv&quot;</span><span class="hljs-punctuation">,</span> <br>                 sep <span class="hljs-operator">=</span> <span class="hljs-string">&quot;,&quot;</span><span class="hljs-punctuation">,</span>           <span class="hljs-comment"># 分隔符</span><br>                 header <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">,</span>       <span class="hljs-comment"># 第一行是否为列名</span><br>                 na.strings <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;NA&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;N/A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span>  <span class="hljs-comment"># 缺失值标记</span><br>                 stringsAsFactors <span class="hljs-operator">=</span> <span class="hljs-literal">FALSE</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 字符串不转为因子</span><br></code></pre></td></tr></table></figure>

<h3 id="2-Excel文件"><a href="#2-Excel文件" class="headerlink" title="2. Excel文件"></a>2. Excel文件</h3><p>处理Excel文件需要额外的包。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 安装和加载readxl包</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;readxl&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>readxl<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 读取Excel文件</span><br>excel_data <span class="hljs-operator">&lt;-</span> read_excel<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;data.xlsx&quot;</span><span class="hljs-punctuation">,</span> sheet <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 读取第一个工作表</span><br><br><span class="hljs-comment"># 或指定工作表名称</span><br>excel_data <span class="hljs-operator">&lt;-</span> read_excel<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;data.xlsx&quot;</span><span class="hljs-punctuation">,</span> sheet <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Sales&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 写入Excel（需要writexl包）</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;writexl&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>writexl<span class="hljs-punctuation">)</span><br>write_xlsx<span class="hljs-punctuation">(</span>sales_data<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;output.xlsx&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="3-R数据文件"><a href="#3-R数据文件" class="headerlink" title="3. R数据文件"></a>3. R数据文件</h3><p>R有自己的数据格式，适合保存R对象。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 保存单个对象</span><br>saveRDS<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;student_data.rds&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 读取RDS文件</span><br>loaded_data <span class="hljs-operator">&lt;-</span> readRDS<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;student_data.rds&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 保存多个对象</span><br>save<span class="hljs-punctuation">(</span>student_data<span class="hljs-punctuation">,</span> sales_data<span class="hljs-punctuation">,</span> file <span class="hljs-operator">=</span> <span class="hljs-string">&quot;my_data.RData&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 加载RData文件</span><br>load<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;my_data.RData&quot;</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 对象会自动加载到环境中</span><br><br><span class="hljs-comment"># 保存整个工作空间</span><br>save.image<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;workspace.RData&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h2 id="数据清洗与处理"><a href="#数据清洗与处理" class="headerlink" title="数据清洗与处理"></a>数据清洗与处理</h2><p>数据清洗是数据分析中最耗时但也最重要的步骤。真实世界的数据通常需要大量清理才能使用。</p>
<h3 id="1-处理缺失值"><a href="#1-处理缺失值" class="headerlink" title="1. 处理缺失值"></a>1. 处理缺失值</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建包含缺失值的数据</span><br>test_data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  id <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">6</span><span class="hljs-punctuation">,</span><br>  value1 <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span> <span class="hljs-number">40</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-number">60</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  value2 <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> <span class="hljs-number">200</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">,</span> <span class="hljs-number">400</span><span class="hljs-punctuation">,</span> <span class="hljs-number">500</span><span class="hljs-punctuation">,</span> <span class="hljs-literal">NA</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 检测缺失值</span><br><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">)</span>                    <span class="hljs-comment"># 返回逻辑矩阵</span><br>complete.cases<span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">)</span>            <span class="hljs-comment"># 检查完整的行</span><br><span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>              <span class="hljs-comment"># 缺失值总数</span><br><br><span class="hljs-comment"># 处理缺失值</span><br><span class="hljs-comment"># 方法1：删除包含NA的行</span><br>clean_data1 <span class="hljs-operator">&lt;-</span> na.omit<span class="hljs-punctuation">(</span>test_data<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 方法2：用特定值填充</span><br>test_data<span class="hljs-operator">$</span>value1<span class="hljs-punctuation">[</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>test_data<span class="hljs-operator">$</span>value1<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> <span class="hljs-number">0</span><br><br><span class="hljs-comment"># 方法3：用平均值填充</span><br>mean_val <span class="hljs-operator">&lt;-</span> mean<span class="hljs-punctuation">(</span>test_data<span class="hljs-operator">$</span>value2<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>test_data<span class="hljs-operator">$</span>value2<span class="hljs-punctuation">[</span><span class="hljs-built_in">is.na</span><span class="hljs-punctuation">(</span>test_data<span class="hljs-operator">$</span>value2<span class="hljs-punctuation">)</span><span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> mean_val<br><br><span class="hljs-comment"># 方法4：向前或向后填充（需要zoo包）</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;zoo&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>zoo<span class="hljs-punctuation">)</span><br>test_data<span class="hljs-operator">$</span>value1 <span class="hljs-operator">&lt;-</span> na.fill<span class="hljs-punctuation">(</span>test_data<span class="hljs-operator">$</span>value1<span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;extend&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="2-数据转换"><a href="#2-数据转换" class="headerlink" title="2. 数据转换"></a>2. 数据转换</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 数据类型转换</span><br>df <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  numbers <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;1&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;2&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;3&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  dates <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;2024-01-01&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;2024-02-01&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;2024-03-01&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  categories <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br>df<span class="hljs-operator">$</span>numbers <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">as.numeric</span><span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>numbers<span class="hljs-punctuation">)</span><br>df<span class="hljs-operator">$</span>dates <span class="hljs-operator">&lt;-</span> as.Date<span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>dates<span class="hljs-punctuation">)</span><br>df<span class="hljs-operator">$</span>categories <span class="hljs-operator">&lt;-</span> as.factor<span class="hljs-punctuation">(</span>df<span class="hljs-operator">$</span>categories<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 数据标准化和归一化</span><br><span class="hljs-comment"># 标准化（z-score）</span><br>standardize <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-punctuation">(</span>x <span class="hljs-operator">-</span> mean<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> sd<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 归一化（0-1范围）</span><br>normalize <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-punctuation">(</span>x <span class="hljs-operator">-</span> <span class="hljs-built_in">min</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">/</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">-</span> <span class="hljs-built_in">min</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 应用转换</span><br>data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  height <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">165</span><span class="hljs-punctuation">,</span> <span class="hljs-number">170</span><span class="hljs-punctuation">,</span> <span class="hljs-number">175</span><span class="hljs-punctuation">,</span> <span class="hljs-number">180</span><span class="hljs-punctuation">,</span> <span class="hljs-number">185</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  weight <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">60</span><span class="hljs-punctuation">,</span> <span class="hljs-number">65</span><span class="hljs-punctuation">,</span> <span class="hljs-number">70</span><span class="hljs-punctuation">,</span> <span class="hljs-number">75</span><span class="hljs-punctuation">,</span> <span class="hljs-number">80</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br>data<span class="hljs-operator">$</span>height_std <span class="hljs-operator">&lt;-</span> standardize<span class="hljs-punctuation">(</span>data<span class="hljs-operator">$</span>height<span class="hljs-punctuation">)</span><br>data<span class="hljs-operator">$</span>weight_norm <span class="hljs-operator">&lt;-</span> normalize<span class="hljs-punctuation">(</span>data<span class="hljs-operator">$</span>weight<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="3-数据重塑"><a href="#3-数据重塑" class="headerlink" title="3. 数据重塑"></a>3. 数据重塑</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 宽格式转长格式（需要reshape2包）</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;reshape2&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>reshape2<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 宽格式数据</span><br>wide_data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  id <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span><br>  jan <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> <span class="hljs-number">110</span><span class="hljs-punctuation">,</span> <span class="hljs-number">120</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  feb <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">105</span><span class="hljs-punctuation">,</span> <span class="hljs-number">115</span><span class="hljs-punctuation">,</span> <span class="hljs-number">125</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  mar <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">110</span><span class="hljs-punctuation">,</span> <span class="hljs-number">120</span><span class="hljs-punctuation">,</span> <span class="hljs-number">130</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 转为长格式</span><br>long_data <span class="hljs-operator">&lt;-</span> melt<span class="hljs-punctuation">(</span>wide_data<span class="hljs-punctuation">,</span> <br>                  id.vars <span class="hljs-operator">=</span> <span class="hljs-string">&quot;id&quot;</span><span class="hljs-punctuation">,</span><br>                  variable.name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;month&quot;</span><span class="hljs-punctuation">,</span><br>                  value.name <span class="hljs-operator">=</span> <span class="hljs-string">&quot;sales&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 长格式转宽格式</span><br>wide_again <span class="hljs-operator">&lt;-</span> dcast<span class="hljs-punctuation">(</span>long_data<span class="hljs-punctuation">,</span> id <span class="hljs-operator">~</span> month<span class="hljs-punctuation">,</span> value.var <span class="hljs-operator">=</span> <span class="hljs-string">&quot;sales&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h2 id="数据可视化基础"><a href="#数据可视化基础" class="headerlink" title="数据可视化基础"></a>数据可视化基础</h2><p>数据可视化是理解数据的重要工具。R提供了强大的绘图功能。</p>
<h3 id="1-基础绘图"><a href="#1-基础绘图" class="headerlink" title="1. 基础绘图"></a>1. 基础绘图</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 准备数据</span><br>x <span class="hljs-operator">&lt;-</span> 1<span class="hljs-operator">:</span><span class="hljs-number">10</span><br>y <span class="hljs-operator">&lt;-</span> x<span class="hljs-operator">^</span><span class="hljs-number">2</span><br><br><span class="hljs-comment"># 散点图</span><br>plot<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">,</span> <br>     main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;二次函数图像&quot;</span><span class="hljs-punctuation">,</span>      <span class="hljs-comment"># 标题</span><br>     xlab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;X轴&quot;</span><span class="hljs-punctuation">,</span>                <span class="hljs-comment"># X轴标签</span><br>     ylab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Y轴&quot;</span><span class="hljs-punctuation">,</span>                <span class="hljs-comment"># Y轴标签</span><br>     col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">,</span>                <span class="hljs-comment"># 颜色</span><br>     pch <span class="hljs-operator">=</span> <span class="hljs-number">16</span><span class="hljs-punctuation">)</span>                    <span class="hljs-comment"># 点的形状</span><br><br><span class="hljs-comment"># 添加线条</span><br>lines<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span> lwd <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># lwd是线宽</span><br><br><span class="hljs-comment"># 直方图</span><br>data <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">1000</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 生成正态分布数据</span><br>hist<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> <br>     breaks <span class="hljs-operator">=</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span>                 <span class="hljs-comment"># 分组数</span><br>     main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;正态分布直方图&quot;</span><span class="hljs-punctuation">,</span><br>     xlab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;值&quot;</span><span class="hljs-punctuation">,</span><br>     col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;lightblue&quot;</span><span class="hljs-punctuation">,</span><br>     border <span class="hljs-operator">=</span> <span class="hljs-string">&quot;black&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 箱线图</span><br>boxplot<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> <br>        main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;数据分布箱线图&quot;</span><span class="hljs-punctuation">,</span><br>        ylab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;值&quot;</span><span class="hljs-punctuation">,</span><br>        col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;lightgreen&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 条形图</span><br>categories <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;C&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;D&quot;</span><span class="hljs-punctuation">)</span><br>values <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">40</span><span class="hljs-punctuation">,</span> <span class="hljs-number">35</span><span class="hljs-punctuation">,</span> <span class="hljs-number">50</span><span class="hljs-punctuation">)</span><br>barplot<span class="hljs-punctuation">(</span>values<span class="hljs-punctuation">,</span> <br>        names.arg <span class="hljs-operator">=</span> categories<span class="hljs-punctuation">,</span><br>        main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;分类数据条形图&quot;</span><span class="hljs-punctuation">,</span><br>        xlab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;类别&quot;</span><span class="hljs-punctuation">,</span><br>        ylab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;数值&quot;</span><span class="hljs-punctuation">,</span><br>        col <span class="hljs-operator">=</span> rainbow<span class="hljs-punctuation">(</span><span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>         <span class="hljs-comment"># 使用彩虹色</span><br><br><span class="hljs-comment"># 饼图</span><br>pie<span class="hljs-punctuation">(</span>values<span class="hljs-punctuation">,</span> <br>    labels <span class="hljs-operator">=</span> categories<span class="hljs-punctuation">,</span><br>    main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;数据占比饼图&quot;</span><span class="hljs-punctuation">,</span><br>    col <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;blue&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;green&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;yellow&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="2-多图布局"><a href="#2-多图布局" class="headerlink" title="2. 多图布局"></a>2. 多图布局</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 设置图形布局</span><br>par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 2行2列的布局</span><br><br><span class="hljs-comment"># 绘制四个图</span><br>plot<span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;l&quot;</span><span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;线图&quot;</span><span class="hljs-punctuation">)</span><br>hist<span class="hljs-punctuation">(</span>rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;直方图&quot;</span><span class="hljs-punctuation">)</span><br>boxplot<span class="hljs-punctuation">(</span>rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;箱线图&quot;</span><span class="hljs-punctuation">)</span><br>barplot<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">3</span><span class="hljs-punctuation">,</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">4</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;条形图&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 恢复默认布局</span><br>par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="3-ggplot2高级绘图"><a href="#3-ggplot2高级绘图" class="headerlink" title="3. ggplot2高级绘图"></a>3. ggplot2高级绘图</h3><p>ggplot2是R中最流行的绘图包，提供了更优雅的绘图语法。</p>
<figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 安装和加载ggplot2</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;ggplot2&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 创建示例数据</span><br>df <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span><br>  x <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  y <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-operator">^</span><span class="hljs-number">0.5</span><span class="hljs-punctuation">,</span> <span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span><span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-operator">^</span><span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>  group <span class="hljs-operator">=</span> <span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;线性&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;平方根&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;平方&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 基础ggplot图</span><br>p <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y<span class="hljs-punctuation">,</span> color <span class="hljs-operator">=</span> group<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">3</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>                    <span class="hljs-comment"># 添加点</span><br>  geom_line<span class="hljs-punctuation">(</span>size <span class="hljs-operator">=</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>                     <span class="hljs-comment"># 添加线</span><br>  labs<span class="hljs-punctuation">(</span>title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;不同函数的比较&quot;</span><span class="hljs-punctuation">,</span><br>       x <span class="hljs-operator">=</span> <span class="hljs-string">&quot;X值&quot;</span><span class="hljs-punctuation">,</span><br>       y <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Y值&quot;</span><span class="hljs-punctuation">,</span><br>       color <span class="hljs-operator">=</span> <span class="hljs-string">&quot;函数类型&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  theme_minimal<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>                          <span class="hljs-comment"># 使用简洁主题</span><br>  theme<span class="hljs-punctuation">(</span>plot.title <span class="hljs-operator">=</span> element_text<span class="hljs-punctuation">(</span>hjust <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 标题居中</span><br><br>print<span class="hljs-punctuation">(</span>p<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 分面图（多个子图）</span><br>p_facet <span class="hljs-operator">&lt;-</span> ggplot<span class="hljs-punctuation">(</span>df<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_smooth<span class="hljs-punctuation">(</span>method <span class="hljs-operator">=</span> <span class="hljs-string">&quot;loess&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>           <span class="hljs-comment"># 添加平滑曲线</span><br>  facet_wrap<span class="hljs-punctuation">(</span><span class="hljs-operator">~</span> group<span class="hljs-punctuation">,</span> scales <span class="hljs-operator">=</span> <span class="hljs-string">&quot;free_y&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  <span class="hljs-comment"># 按group分面</span><br>  theme_bw<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br><br>print<span class="hljs-punctuation">(</span>p_facet<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h2 id="基础统计分析"><a href="#基础统计分析" class="headerlink" title="基础统计分析"></a>基础统计分析</h2><p>R的强大之处在于其统计分析能力。让我们学习一些基础的统计方法。</p>
<h3 id="1-描述性统计"><a href="#1-描述性统计" class="headerlink" title="1. 描述性统计"></a>1. 描述性统计</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 生成示例数据</span><br>set.seed<span class="hljs-punctuation">(</span><span class="hljs-number">123</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 设置随机种子，保证结果可重现</span><br>data <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 基本统计量</span><br>mean<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                  <span class="hljs-comment"># 均值</span><br>median<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                <span class="hljs-comment"># 中位数</span><br>sd<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                    <span class="hljs-comment"># 标准差</span><br>var<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 方差</span><br><span class="hljs-built_in">min</span><span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 最小值</span><br><span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 最大值</span><br><span class="hljs-built_in">range</span><span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                 <span class="hljs-comment"># 范围（最小值和最大值）</span><br>quantile<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">0.25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 四分位数</span><br><br><span class="hljs-comment"># 综合统计摘要</span><br>summary<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 自定义描述统计函数</span><br>describe_data <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span><br>    n <span class="hljs-operator">=</span> <span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    mean <span class="hljs-operator">=</span> mean<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    median <span class="hljs-operator">=</span> median<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    sd <span class="hljs-operator">=</span> sd<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-built_in">min</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">min</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    <span class="hljs-built_in">max</span> <span class="hljs-operator">=</span> <span class="hljs-built_in">max</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    q25 <span class="hljs-operator">=</span> quantile<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> <span class="hljs-number">0.25</span><span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>    q75 <span class="hljs-operator">=</span> quantile<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> <span class="hljs-number">0.75</span><span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br>stats <span class="hljs-operator">&lt;-</span> describe_data<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>stats<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="2-假设检验"><a href="#2-假设检验" class="headerlink" title="2. 假设检验"></a>2. 假设检验</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># t检验</span><br><span class="hljs-comment"># 单样本t检验：检验均值是否等于某个值</span><br>t.test<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> mu <span class="hljs-operator">=</span> <span class="hljs-number">50</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 检验均值是否等于50</span><br><br><span class="hljs-comment"># 双样本t检验：比较两组数据的均值</span><br>group1 <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">50</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">50</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">)</span><br>group2 <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">50</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">52</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">)</span><br>t.test<span class="hljs-punctuation">(</span>group1<span class="hljs-punctuation">,</span> group2<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 默认是韦尔奇t检验（方差不等）</span><br>t.test<span class="hljs-punctuation">(</span>group1<span class="hljs-punctuation">,</span> group2<span class="hljs-punctuation">,</span> var.equal <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 方差相等的t检验</span><br><br><span class="hljs-comment"># 配对t检验</span><br>before <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">15</span><span class="hljs-punctuation">)</span><br>after <span class="hljs-operator">&lt;-</span> before <span class="hljs-operator">+</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">30</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">5</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 有改善</span><br>t.test<span class="hljs-punctuation">(</span>before<span class="hljs-punctuation">,</span> after<span class="hljs-punctuation">,</span> paired <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 卡方检验</span><br><span class="hljs-comment"># 创建列联表</span><br>observed <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span> <span class="hljs-number">30</span><span class="hljs-punctuation">,</span> <span class="hljs-number">25</span><span class="hljs-punctuation">,</span> <span class="hljs-number">25</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>chisq.test<span class="hljs-punctuation">(</span>observed<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 方差分析（ANOVA）</span><br><span class="hljs-comment"># 创建示例数据</span><br>treatment <span class="hljs-operator">&lt;-</span> factor<span class="hljs-punctuation">(</span><span class="hljs-built_in">rep</span><span class="hljs-punctuation">(</span><span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-string">&quot;A&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;B&quot;</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;C&quot;</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> each <span class="hljs-operator">=</span> <span class="hljs-number">20</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>response <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>              rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">12</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> <br>              rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">20</span><span class="hljs-punctuation">,</span> mean <span class="hljs-operator">=</span> <span class="hljs-number">11</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>              <br><span class="hljs-comment"># 单因素方差分析</span><br>model <span class="hljs-operator">&lt;-</span> aov<span class="hljs-punctuation">(</span>response <span class="hljs-operator">~</span> treatment<span class="hljs-punctuation">)</span><br>summary<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 事后检验（如果ANOVA显著）</span><br>TukeyHSD<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="3-相关性分析"><a href="#3-相关性分析" class="headerlink" title="3. 相关性分析"></a>3. 相关性分析</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建相关数据</span><br>x <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span><br>y <span class="hljs-operator">&lt;-</span> 2 <span class="hljs-operator">*</span> x <span class="hljs-operator">+</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">0.5</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># y与x有较强相关性</span><br>z <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># z与x、y无关</span><br><br>data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y<span class="hljs-punctuation">,</span> z <span class="hljs-operator">=</span> z<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 相关系数</span><br>cor<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">)</span>                    <span class="hljs-comment"># 皮尔逊相关系数</span><br>cor<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span>                    <span class="hljs-comment"># 相关矩阵</span><br>cor<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> method <span class="hljs-operator">=</span> <span class="hljs-string">&quot;spearman&quot;</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 斯皮尔曼等级相关</span><br><br><span class="hljs-comment"># 相关性检验</span><br>cor.test<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">)</span>               <span class="hljs-comment"># 检验相关性是否显著</span><br><br><span class="hljs-comment"># 可视化相关矩阵</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;corrplot&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>corrplot<span class="hljs-punctuation">)</span><br>cor_matrix <span class="hljs-operator">&lt;-</span> cor<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">)</span><br>corrplot<span class="hljs-punctuation">(</span>cor_matrix<span class="hljs-punctuation">,</span> method <span class="hljs-operator">=</span> <span class="hljs-string">&quot;circle&quot;</span><span class="hljs-punctuation">,</span> type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;upper&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h2 id="线性回归"><a href="#线性回归" class="headerlink" title="线性回归"></a>线性回归</h2><p>线性回归是最基础也是最重要的统计模型之一。</p>
<h3 id="1-简单线性回归"><a href="#1-简单线性回归" class="headerlink" title="1. 简单线性回归"></a>1. 简单线性回归</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建示例数据</span><br>set.seed<span class="hljs-punctuation">(</span><span class="hljs-number">123</span><span class="hljs-punctuation">)</span><br>x <span class="hljs-operator">&lt;-</span> 1<span class="hljs-operator">:</span><span class="hljs-number">100</span><br>y <span class="hljs-operator">&lt;-</span> 2 <span class="hljs-operator">*</span> x <span class="hljs-operator">+</span> <span class="hljs-number">3</span> <span class="hljs-operator">+</span> rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">100</span><span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">10</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># y = 2x + 3 + 噪声</span><br>data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 建立线性模型</span><br>model <span class="hljs-operator">&lt;-</span> lm<span class="hljs-punctuation">(</span>y <span class="hljs-operator">~</span> x<span class="hljs-punctuation">,</span> data <span class="hljs-operator">=</span> data<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># y ~ x 表示 y 对 x 回归</span><br><br><span class="hljs-comment"># 查看模型结果</span><br>summary<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 详细的统计结果</span><br>coef<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span>                      <span class="hljs-comment"># 系数</span><br>confint<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span>                   <span class="hljs-comment"># 系数的置信区间</span><br><br><span class="hljs-comment"># 预测</span><br>new_data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">101</span><span class="hljs-punctuation">,</span> <span class="hljs-number">102</span><span class="hljs-punctuation">,</span> <span class="hljs-number">103</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>predictions <span class="hljs-operator">&lt;-</span> predict<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">,</span> newdata <span class="hljs-operator">=</span> new_data<span class="hljs-punctuation">)</span><br>print<span class="hljs-punctuation">(</span>predictions<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 带置信区间的预测</span><br>predict<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">,</span> newdata <span class="hljs-operator">=</span> new_data<span class="hljs-punctuation">,</span> interval <span class="hljs-operator">=</span> <span class="hljs-string">&quot;confidence&quot;</span><span class="hljs-punctuation">)</span><br>predict<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">,</span> newdata <span class="hljs-operator">=</span> new_data<span class="hljs-punctuation">,</span> interval <span class="hljs-operator">=</span> <span class="hljs-string">&quot;prediction&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 可视化</span><br>plot<span class="hljs-punctuation">(</span>data<span class="hljs-operator">$</span>x<span class="hljs-punctuation">,</span> data<span class="hljs-operator">$</span>y<span class="hljs-punctuation">,</span> <br>     main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;线性回归&quot;</span><span class="hljs-punctuation">,</span><br>     xlab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;X&quot;</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Y&quot;</span><span class="hljs-punctuation">)</span><br>abline<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span> lwd <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 添加回归线</span><br><br><span class="hljs-comment"># 或使用ggplot2</span><br>library<span class="hljs-punctuation">(</span>ggplot2<span class="hljs-punctuation">)</span><br>ggplot<span class="hljs-punctuation">(</span>data<span class="hljs-punctuation">,</span> aes<span class="hljs-punctuation">(</span>x <span class="hljs-operator">=</span> x<span class="hljs-punctuation">,</span> y <span class="hljs-operator">=</span> y<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_point<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span><br>  geom_smooth<span class="hljs-punctuation">(</span>method <span class="hljs-operator">=</span> <span class="hljs-string">&quot;lm&quot;</span><span class="hljs-punctuation">,</span> se <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span> <span class="hljs-operator">+</span>  <span class="hljs-comment"># se=TRUE显示置信带</span><br>  labs<span class="hljs-punctuation">(</span>title <span class="hljs-operator">=</span> <span class="hljs-string">&quot;线性回归分析&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="2-多元线性回归"><a href="#2-多元线性回归" class="headerlink" title="2. 多元线性回归"></a>2. 多元线性回归</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 创建多变量数据</span><br>n <span class="hljs-operator">&lt;-</span> 100<br>x1 <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span><br>x2 <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span><br>x3 <span class="hljs-operator">&lt;-</span> rnorm<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span><br>y <span class="hljs-operator">&lt;-</span> 2<span class="hljs-operator">*</span>x1 <span class="hljs-operator">+</span> <span class="hljs-number">3</span><span class="hljs-operator">*</span>x2 <span class="hljs-operator">-</span> x3 <span class="hljs-operator">+</span> <span class="hljs-number">5</span> <span class="hljs-operator">+</span> rnorm<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">,</span> sd <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br>data <span class="hljs-operator">&lt;-</span> data.frame<span class="hljs-punctuation">(</span>y<span class="hljs-punctuation">,</span> x1<span class="hljs-punctuation">,</span> x2<span class="hljs-punctuation">,</span> x3<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 建立多元回归模型</span><br>model_multi <span class="hljs-operator">&lt;-</span> lm<span class="hljs-punctuation">(</span>y <span class="hljs-operator">~</span> x1 <span class="hljs-operator">+</span> x2 <span class="hljs-operator">+</span> x3<span class="hljs-punctuation">,</span> data <span class="hljs-operator">=</span> data<span class="hljs-punctuation">)</span><br>summary<span class="hljs-punctuation">(</span>model_multi<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 逐步回归（变量选择）</span><br><span class="hljs-comment"># 向前选择</span><br>model_null <span class="hljs-operator">&lt;-</span> lm<span class="hljs-punctuation">(</span>y <span class="hljs-operator">~</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> data <span class="hljs-operator">=</span> data<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 空模型</span><br>model_full <span class="hljs-operator">&lt;-</span> lm<span class="hljs-punctuation">(</span>y <span class="hljs-operator">~</span> .<span class="hljs-punctuation">,</span> data <span class="hljs-operator">=</span> data<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 全模型</span><br><br><span class="hljs-comment"># 使用AIC准则进行逐步回归</span><br>step_model <span class="hljs-operator">&lt;-</span> step<span class="hljs-punctuation">(</span>model_null<span class="hljs-punctuation">,</span> <br>                   scope <span class="hljs-operator">=</span> <span class="hljs-built_in">list</span><span class="hljs-punctuation">(</span>lower <span class="hljs-operator">=</span> model_null<span class="hljs-punctuation">,</span> upper <span class="hljs-operator">=</span> model_full<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span><br>                   direction <span class="hljs-operator">=</span> <span class="hljs-string">&quot;forward&quot;</span><span class="hljs-punctuation">)</span><br></code></pre></td></tr></table></figure>

<h3 id="3-模型诊断"><a href="#3-模型诊断" class="headerlink" title="3. 模型诊断"></a>3. 模型诊断</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 残差分析</span><br>residuals <span class="hljs-operator">&lt;-</span> residuals<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span><br>fitted_values <span class="hljs-operator">&lt;-</span> fitted<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 残差图</span><br>par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">2</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 自动生成4个诊断图</span><br>par<span class="hljs-punctuation">(</span>mfrow <span class="hljs-operator">=</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 手动创建诊断图</span><br><span class="hljs-comment"># 1. 残差vs拟合值（检查线性假设和方差齐性）</span><br>plot<span class="hljs-punctuation">(</span>fitted_values<span class="hljs-punctuation">,</span> residuals<span class="hljs-punctuation">,</span><br>     main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;残差 vs 拟合值&quot;</span><span class="hljs-punctuation">,</span><br>     xlab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;拟合值&quot;</span><span class="hljs-punctuation">,</span> ylab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;残差&quot;</span><span class="hljs-punctuation">)</span><br>abline<span class="hljs-punctuation">(</span>h <span class="hljs-operator">=</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span> lty <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 2. Q-Q图（检查正态性假设）</span><br>qqnorm<span class="hljs-punctuation">(</span>residuals<span class="hljs-punctuation">)</span><br>qqline<span class="hljs-punctuation">(</span>residuals<span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 3. 检查异常值和影响点</span><br>cooksd <span class="hljs-operator">&lt;-</span> cooks.distance<span class="hljs-punctuation">(</span>model<span class="hljs-punctuation">)</span><br>plot<span class="hljs-punctuation">(</span>cooksd<span class="hljs-punctuation">,</span> type <span class="hljs-operator">=</span> <span class="hljs-string">&quot;h&quot;</span><span class="hljs-punctuation">,</span><br>     main <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Cook&#x27;s距离&quot;</span><span class="hljs-punctuation">,</span><br>     ylab <span class="hljs-operator">=</span> <span class="hljs-string">&quot;Cook&#x27;s距离&quot;</span><span class="hljs-punctuation">)</span><br>abline<span class="hljs-punctuation">(</span>h <span class="hljs-operator">=</span> <span class="hljs-number">4</span><span class="hljs-operator">/</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>cooksd<span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> col <span class="hljs-operator">=</span> <span class="hljs-string">&quot;red&quot;</span><span class="hljs-punctuation">,</span> lty <span class="hljs-operator">=</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># VIF检查多重共线性（需要car包）</span><br>install.packages<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;car&quot;</span><span class="hljs-punctuation">)</span><br>library<span class="hljs-punctuation">(</span>car<span class="hljs-punctuation">)</span><br>vif<span class="hljs-punctuation">(</span>model_multi<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># VIF &gt; 5或10表示可能存在多重共线性</span><br></code></pre></td></tr></table></figure>

<h2 id="实用技巧和最佳实践"><a href="#实用技巧和最佳实践" class="headerlink" title="实用技巧和最佳实践"></a>实用技巧和最佳实践</h2><h3 id="1-代码组织"><a href="#1-代码组织" class="headerlink" title="1. 代码组织"></a>1. 代码组织</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 项目结构建议</span><br><span class="hljs-comment"># project/</span><br><span class="hljs-comment"># ├── data/          # 原始数据</span><br><span class="hljs-comment"># ├── scripts/       # R脚本</span><br><span class="hljs-comment"># ├── output/        # 结果输出</span><br><span class="hljs-comment"># └── functions/     # 自定义函数</span><br><br><span class="hljs-comment"># 设置工作目录</span><br>setwd<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;~/my_project&quot;</span><span class="hljs-punctuation">)</span><br>getwd<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 查看当前工作目录</span><br><br><span class="hljs-comment"># 使用相对路径</span><br>data <span class="hljs-operator">&lt;-</span> read.csv<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;data/my_data.csv&quot;</span><span class="hljs-punctuation">)</span><br>source<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;functions/my_functions.R&quot;</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 加载自定义函数文件</span><br><br><span class="hljs-comment"># 清理环境</span><br>rm<span class="hljs-punctuation">(</span><span class="hljs-built_in">list</span> <span class="hljs-operator">=</span> ls<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 清空所有变量</span><br>gc<span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span>             <span class="hljs-comment"># 垃圾回收，释放内存</span><br></code></pre></td></tr></table></figure>

<h3 id="2-错误处理"><a href="#2-错误处理" class="headerlink" title="2. 错误处理"></a>2. 错误处理</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># try-catch结构</span><br>safe_divide <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> y<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  result <span class="hljs-operator">&lt;-</span> tryCatch<span class="hljs-punctuation">(</span><span class="hljs-punctuation">&#123;</span><br>    x <span class="hljs-operator">/</span> y<br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> error <span class="hljs-operator">=</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>e<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;错误:&quot;</span><span class="hljs-punctuation">,</span> e<span class="hljs-operator">$</span>message<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">,</span> warning <span class="hljs-operator">=</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>w<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    print<span class="hljs-punctuation">(</span>paste<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;警告:&quot;</span><span class="hljs-punctuation">,</span> w<span class="hljs-operator">$</span>message<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>x <span class="hljs-operator">/</span> y<span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>result<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 测试函数</span><br>safe_divide<span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-number">2</span><span class="hljs-punctuation">)</span>   <span class="hljs-comment"># 正常：5</span><br>safe_divide<span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span>   <span class="hljs-comment"># 产生警告：Inf</span><br>safe_divide<span class="hljs-punctuation">(</span><span class="hljs-number">10</span><span class="hljs-punctuation">,</span> <span class="hljs-string">&quot;a&quot;</span><span class="hljs-punctuation">)</span> <span class="hljs-comment"># 产生错误：NA</span><br><br><span class="hljs-comment"># 输入验证</span><br>robust_mean <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-operator">!</span><span class="hljs-built_in">is.numeric</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    stop<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;输入必须是数值型&quot;</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-keyword">if</span> <span class="hljs-punctuation">(</span><span class="hljs-built_in">length</span><span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">)</span> <span class="hljs-operator">==</span> <span class="hljs-number">0</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    warning<span class="hljs-punctuation">(</span><span class="hljs-string">&quot;输入为空向量&quot;</span><span class="hljs-punctuation">)</span><br>    <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span><span class="hljs-literal">NA</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>mean<span class="hljs-punctuation">(</span>x<span class="hljs-punctuation">,</span> na.rm <span class="hljs-operator">=</span> <span class="hljs-literal">TRUE</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<h3 id="3-性能优化"><a href="#3-性能优化" class="headerlink" title="3. 性能优化"></a>3. 性能优化</h3><figure class="highlight r"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><code class="hljs R"><span class="hljs-comment"># 向量化操作（避免循环）</span><br><span class="hljs-comment"># 慢速方法</span><br>slow_sum <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  total <span class="hljs-operator">&lt;-</span> 0<br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    total <span class="hljs-operator">&lt;-</span> total <span class="hljs-operator">+</span> i<br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>total<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 快速方法</span><br>fast_sum <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  <span class="hljs-built_in">sum</span><span class="hljs-punctuation">(</span><span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 比较运行时间</span><br>system.time<span class="hljs-punctuation">(</span>slow_sum<span class="hljs-punctuation">(</span><span class="hljs-number">1000000</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br>system.time<span class="hljs-punctuation">(</span>fast_sum<span class="hljs-punctuation">(</span><span class="hljs-number">1000000</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 预分配内存</span><br><span class="hljs-comment"># 慢速方法</span><br>slow_grow <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  vec <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span><span class="hljs-punctuation">)</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    vec <span class="hljs-operator">&lt;-</span> <span class="hljs-built_in">c</span><span class="hljs-punctuation">(</span>vec<span class="hljs-punctuation">,</span> i<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 每次都重新分配内存</span><br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>vec<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 快速方法</span><br>fast_grow <span class="hljs-operator">&lt;-</span> <span class="hljs-keyword">function</span><span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  vec <span class="hljs-operator">&lt;-</span> numeric<span class="hljs-punctuation">(</span>n<span class="hljs-punctuation">)</span>  <span class="hljs-comment"># 预分配内存</span><br>  <span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>n<span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>    vec<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> i<br>  <span class="hljs-punctuation">&#125;</span><br>  <span class="hljs-built_in">return</span><span class="hljs-punctuation">(</span>vec<span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br><br><span class="hljs-comment"># 使用apply函数代替循环</span><br><span class="hljs-comment"># 计算矩阵每行的标准差</span><br>mat <span class="hljs-operator">&lt;-</span> matrix<span class="hljs-punctuation">(</span>rnorm<span class="hljs-punctuation">(</span><span class="hljs-number">10000</span><span class="hljs-punctuation">)</span><span class="hljs-punctuation">,</span> nrow <span class="hljs-operator">=</span> <span class="hljs-number">100</span><span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 使用apply（推荐）</span><br>row_sds <span class="hljs-operator">&lt;-</span> apply<span class="hljs-punctuation">(</span>mat<span class="hljs-punctuation">,</span> <span class="hljs-number">1</span><span class="hljs-punctuation">,</span> sd<span class="hljs-punctuation">)</span><br><br><span class="hljs-comment"># 使用循环（不推荐）</span><br>row_sds_loop <span class="hljs-operator">&lt;-</span> numeric<span class="hljs-punctuation">(</span>nrow<span class="hljs-punctuation">(</span>mat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span><br><span class="hljs-keyword">for</span> <span class="hljs-punctuation">(</span>i <span class="hljs-keyword">in</span> <span class="hljs-number">1</span><span class="hljs-operator">:</span>nrow<span class="hljs-punctuation">(</span>mat<span class="hljs-punctuation">)</span><span class="hljs-punctuation">)</span> <span class="hljs-punctuation">&#123;</span><br>  row_sds_loop<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">]</span> <span class="hljs-operator">&lt;-</span> sd<span class="hljs-punctuation">(</span>mat<span class="hljs-punctuation">[</span>i<span class="hljs-punctuation">,</span> <span class="hljs-punctuation">]</span><span class="hljs-punctuation">)</span><br><span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure>

<div id="paginator"></div></div><div id="post-footer"><div id="pages" style="justify-content: flex-end"><div class="footer-link" style="width: 50%;right:1px;border-left:1px #fe2 solid"><a href="/2025/08/26/%E6%A0%91%E8%8E%93%E6%B4%BE%E5%B0%8F%E8%BD%A6%E6%8B%93%E5%B1%95%E5%A5%97%E4%BB%B6/">不推荐购买树莓派小车拓展套件 Prev →</a></div></div></div></div><div class="bottom-btn"><div><a class="i-top" id="to-top" onClick="scrolls.scrolltop();" title="To Top" style="opacity: 0; display: none;">∧ </a><a class="i-index" id="to-index" href="#toc-div" title="To Catalog">≡</a><a class="i-color" id="color-mode" onClick="colorMode.change()" title="Change Theme"></a></div></div></article><aside><div id="about"><a href="/" id="logo"><img src="https://ak.hypergryph.com/assets/index/images/ak/pc/faction/1.png" alt="Logo"></a><h1 id="Dr"><a href="/">Zenith</a></h1><div id="description"><p>未经审视的人生是不值得过的人生</p></div></div><div id="aside-block"><div id="toc-div"><h1>Catalog</h1><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85R%E8%AF%AD%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">安装R语言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85RStudio"><span class="toc-number">2.</span> <span class="toc-text">安装RStudio</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDISLR2%E6%95%B0%E6%8D%AE%E9%9B%86"><span class="toc-number">3.</span> <span class="toc-text">下载ISLR2数据集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#R%E8%AF%AD%E8%A8%80%E5%9F%BA%E7%A1%80"><span class="toc-number">4.</span> <span class="toc-text">R语言基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-R%E4%BD%9C%E4%B8%BA%E8%AE%A1%E7%AE%97%E5%99%A8"><span class="toc-number">4.1.</span> <span class="toc-text">1. R作为计算器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8F%98%E9%87%8F%E5%92%8C%E8%B5%8B%E5%80%BC"><span class="toc-number">4.2.</span> <span class="toc-text">2. 变量和赋值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">4.3.</span> <span class="toc-text">3. 数据类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E5%90%91%E9%87%8F%EF%BC%88Vector%EF%BC%89"><span class="toc-number">4.4.</span> <span class="toc-text">4. 向量（Vector）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E7%9F%A9%E9%98%B5%EF%BC%88Matrix%EF%BC%89"><span class="toc-number">4.5.</span> <span class="toc-text">5. 矩阵（Matrix）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E6%95%B0%E6%8D%AE%E6%A1%86%EF%BC%88Data-Frame%EF%BC%89"><span class="toc-number">4.6.</span> <span class="toc-text">6. 数据框（Data Frame）</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-%E5%88%97%E8%A1%A8%EF%BC%88List%EF%BC%89"><span class="toc-number">4.7.</span> <span class="toc-text">7. 列表（List）</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E7%BB%93%E6%9E%84"><span class="toc-number">5.</span> <span class="toc-text">控制结构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%9D%A1%E4%BB%B6%E8%AF%AD%E5%8F%A5"><span class="toc-number">5.1.</span> <span class="toc-text">1. 条件语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%BE%AA%E7%8E%AF%E7%BB%93%E6%9E%84"><span class="toc-number">5.2.</span> <span class="toc-text">2. 循环结构</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">6.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%88%9B%E5%BB%BA%E5%87%BD%E6%95%B0"><span class="toc-number">6.1.</span> <span class="toc-text">1. 创建函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%87%BD%E6%95%B0%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">6.2.</span> <span class="toc-text">2. 函数作用域</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0"><span class="toc-number">6.3.</span> <span class="toc-text">3. 高阶函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%AF%BC%E5%85%A5%E4%B8%8E%E5%AF%BC%E5%87%BA"><span class="toc-number">7.</span> <span class="toc-text">数据导入与导出</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-CSV%E6%96%87%E4%BB%B6"><span class="toc-number">7.1.</span> <span class="toc-text">1. CSV文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-Excel%E6%96%87%E4%BB%B6"><span class="toc-number">7.2.</span> <span class="toc-text">2. Excel文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-R%E6%95%B0%E6%8D%AE%E6%96%87%E4%BB%B6"><span class="toc-number">7.3.</span> <span class="toc-text">3. R数据文件</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%B8%85%E6%B4%97%E4%B8%8E%E5%A4%84%E7%90%86"><span class="toc-number">8.</span> <span class="toc-text">数据清洗与处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%84%E7%90%86%E7%BC%BA%E5%A4%B1%E5%80%BC"><span class="toc-number">8.1.</span> <span class="toc-text">1. 处理缺失值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%95%B0%E6%8D%AE%E8%BD%AC%E6%8D%A2"><span class="toc-number">8.2.</span> <span class="toc-text">2. 数据转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%95%B0%E6%8D%AE%E9%87%8D%E5%A1%91"><span class="toc-number">8.3.</span> <span class="toc-text">3. 数据重塑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%AF%E8%A7%86%E5%8C%96%E5%9F%BA%E7%A1%80"><span class="toc-number">9.</span> <span class="toc-text">数据可视化基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%9F%BA%E7%A1%80%E7%BB%98%E5%9B%BE"><span class="toc-number">9.1.</span> <span class="toc-text">1. 基础绘图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%9A%E5%9B%BE%E5%B8%83%E5%B1%80"><span class="toc-number">9.2.</span> <span class="toc-text">2. 多图布局</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-ggplot2%E9%AB%98%E7%BA%A7%E7%BB%98%E5%9B%BE"><span class="toc-number">9.3.</span> <span class="toc-text">3. ggplot2高级绘图</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E7%BB%9F%E8%AE%A1%E5%88%86%E6%9E%90"><span class="toc-number">10.</span> <span class="toc-text">基础统计分析</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E6%8F%8F%E8%BF%B0%E6%80%A7%E7%BB%9F%E8%AE%A1"><span class="toc-number">10.1.</span> <span class="toc-text">1. 描述性统计</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%81%87%E8%AE%BE%E6%A3%80%E9%AA%8C"><span class="toc-number">10.2.</span> <span class="toc-text">2. 假设检验</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E7%9B%B8%E5%85%B3%E6%80%A7%E5%88%86%E6%9E%90"><span class="toc-number">10.3.</span> <span class="toc-text">3. 相关性分析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-number">11.</span> <span class="toc-text">线性回归</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%AE%80%E5%8D%95%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-number">11.1.</span> <span class="toc-text">1. 简单线性回归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A4%9A%E5%85%83%E7%BA%BF%E6%80%A7%E5%9B%9E%E5%BD%92"><span class="toc-number">11.2.</span> <span class="toc-text">2. 多元线性回归</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%A8%A1%E5%9E%8B%E8%AF%8A%E6%96%AD"><span class="toc-number">11.3.</span> <span class="toc-text">3. 模型诊断</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E7%94%A8%E6%8A%80%E5%B7%A7%E5%92%8C%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5"><span class="toc-number">12.</span> <span class="toc-text">实用技巧和最佳实践</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E4%BB%A3%E7%A0%81%E7%BB%84%E7%BB%87"><span class="toc-number">12.1.</span> <span class="toc-text">1. 代码组织</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86"><span class="toc-number">12.2.</span> <span class="toc-text">2. 错误处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96"><span class="toc-number">12.3.</span> <span class="toc-text">3. 性能优化</span></a></li></ol></li></ol></div></div><footer><nobr><span class="icp-title">♖</span><a class="icp-content" href="https://smallgoodgood.top/about/">关于本站</a></nobr><br><nobr>Pubulished by <a href="http://smallgoodgood.top">Zenith <br></a></nobr><wbr><!-- 添加网站运行时间 --><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now = new Date();

function createtime() {
  var grt = new Date("02/09/2024 00:00:00"); //此处修改你的建站时间或者网站上线时间 
  now.setTime(now.getTime() + 250);
  days = (now - grt) / 1000 / 60 / 60 / 24;
  dnum = Math.floor(days);
  hours = (now - grt) / 1000 / 60 / 60 - (24 * dnum);
  hnum = Math.floor(hours);
  if (String(hnum).length == 1) {
      hnum = "0" + hnum;
  }
  minutes = (now - grt) / 1000 / 60 - (24 * 60 * dnum) - (60 * hnum);
  mnum = Math.floor(minutes);
  if (String(mnum).length == 1) {
      mnum = "0" + mnum;
  }
  seconds = (now - grt) / 1000 - (24 * 60 * 60 * dnum) - (60 * 60 * hnum) - (60 * mnum);
  snum = Math.round(seconds);
  if (String(snum).length == 1) {
      snum = "0" + snum;
  }
  document.getElementById("timeDate").innerHTML = " | 本站已安全运行 " + dnum + " 天 ";
  document.getElementById("times").innerHTML = hnum + " 小时 " + mnum + " 分 " + snum + " 秒";
}
setInterval("createtime()", 250);
<!-- 添加网站运行时间 -->

</script></footer></aside></main><canvas id="canvas-dust"></canvas><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/hijiki.model.json"},"display":{"position":"left","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>